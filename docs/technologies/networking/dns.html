<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DNS | Marcin Jahn | Tech Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="Domain Name Services">
    <meta property="og:url" content="/technologies/networking/dns.html">
    <meta property="og:site_name" content="Marcin Jahn | Tech Notebook">
    <meta property="og:title" content="DNS">
    <meta property="og:description" content="Domain Name Services">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Tech Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="#7D84B2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.986ab28c.css" as="style"><link rel="preload" href="/assets/js/app.8a08511c.js" as="script"><link rel="preload" href="/assets/js/2.e154a615.js" as="script"><link rel="preload" href="/assets/js/31.42571625.js" as="script"><link rel="prefetch" href="/assets/js/10.037f1077.js"><link rel="prefetch" href="/assets/js/100.8950cdb4.js"><link rel="prefetch" href="/assets/js/101.562f18ad.js"><link rel="prefetch" href="/assets/js/102.3af8df3e.js"><link rel="prefetch" href="/assets/js/103.6093062f.js"><link rel="prefetch" href="/assets/js/104.45324be6.js"><link rel="prefetch" href="/assets/js/105.89dbc703.js"><link rel="prefetch" href="/assets/js/106.0a4b7606.js"><link rel="prefetch" href="/assets/js/107.34946db6.js"><link rel="prefetch" href="/assets/js/108.4c1b425c.js"><link rel="prefetch" href="/assets/js/109.dd0b6a9e.js"><link rel="prefetch" href="/assets/js/11.2936e157.js"><link rel="prefetch" href="/assets/js/110.329e4130.js"><link rel="prefetch" href="/assets/js/111.e3230ec8.js"><link rel="prefetch" href="/assets/js/112.445798e9.js"><link rel="prefetch" href="/assets/js/113.d906f1b2.js"><link rel="prefetch" href="/assets/js/114.a53da7d4.js"><link rel="prefetch" href="/assets/js/115.1843640c.js"><link rel="prefetch" href="/assets/js/116.c2fe2378.js"><link rel="prefetch" href="/assets/js/117.a32bb625.js"><link rel="prefetch" href="/assets/js/118.a5c17a83.js"><link rel="prefetch" href="/assets/js/119.f9db55d1.js"><link rel="prefetch" href="/assets/js/12.944c2a3a.js"><link rel="prefetch" href="/assets/js/120.1cf9c83f.js"><link rel="prefetch" href="/assets/js/121.1364a18c.js"><link rel="prefetch" href="/assets/js/122.33442eaa.js"><link rel="prefetch" href="/assets/js/123.ca9f92ed.js"><link rel="prefetch" href="/assets/js/124.61ccb355.js"><link rel="prefetch" href="/assets/js/125.63d56d53.js"><link rel="prefetch" href="/assets/js/126.d205d241.js"><link rel="prefetch" href="/assets/js/127.74cc9d56.js"><link rel="prefetch" href="/assets/js/128.d81a8c68.js"><link rel="prefetch" href="/assets/js/129.9323dcea.js"><link rel="prefetch" href="/assets/js/13.db34d46e.js"><link rel="prefetch" href="/assets/js/130.dba0f1d6.js"><link rel="prefetch" href="/assets/js/131.a5fbefc4.js"><link rel="prefetch" href="/assets/js/132.ddb5c037.js"><link rel="prefetch" href="/assets/js/133.66ca4848.js"><link rel="prefetch" href="/assets/js/134.aec8bcb8.js"><link rel="prefetch" href="/assets/js/135.8a1c38b4.js"><link rel="prefetch" href="/assets/js/136.9429df7b.js"><link rel="prefetch" href="/assets/js/137.21772da9.js"><link rel="prefetch" href="/assets/js/138.c24f7438.js"><link rel="prefetch" href="/assets/js/139.9f9ba9c1.js"><link rel="prefetch" href="/assets/js/14.ab8e1dcc.js"><link rel="prefetch" href="/assets/js/140.1a29d9db.js"><link rel="prefetch" href="/assets/js/141.37b867cc.js"><link rel="prefetch" href="/assets/js/142.a7c2a7e8.js"><link rel="prefetch" href="/assets/js/143.bff44da7.js"><link rel="prefetch" href="/assets/js/144.42f37a4e.js"><link rel="prefetch" href="/assets/js/145.e4e466d7.js"><link rel="prefetch" href="/assets/js/146.88cc43ac.js"><link rel="prefetch" href="/assets/js/147.2c7a1927.js"><link rel="prefetch" href="/assets/js/148.bee765f7.js"><link rel="prefetch" href="/assets/js/149.c31b6c38.js"><link rel="prefetch" href="/assets/js/15.89e1dd21.js"><link rel="prefetch" href="/assets/js/16.2a55624c.js"><link rel="prefetch" href="/assets/js/17.21141d04.js"><link rel="prefetch" href="/assets/js/18.26791088.js"><link rel="prefetch" href="/assets/js/19.cf1af818.js"><link rel="prefetch" href="/assets/js/20.1c8e8717.js"><link rel="prefetch" href="/assets/js/21.10c03aef.js"><link rel="prefetch" href="/assets/js/22.a404cd1c.js"><link rel="prefetch" href="/assets/js/23.274ceaea.js"><link rel="prefetch" href="/assets/js/24.27a64865.js"><link rel="prefetch" href="/assets/js/25.94bee11c.js"><link rel="prefetch" href="/assets/js/26.cf66389e.js"><link rel="prefetch" href="/assets/js/27.a84a9aba.js"><link rel="prefetch" href="/assets/js/28.53d02c91.js"><link rel="prefetch" href="/assets/js/29.cc94ffc9.js"><link rel="prefetch" href="/assets/js/3.54e9968c.js"><link rel="prefetch" href="/assets/js/30.ed0d320d.js"><link rel="prefetch" href="/assets/js/32.3b90ff2a.js"><link rel="prefetch" href="/assets/js/33.e414a879.js"><link rel="prefetch" href="/assets/js/34.1bec9902.js"><link rel="prefetch" href="/assets/js/35.a682d85c.js"><link rel="prefetch" href="/assets/js/36.2c3f8f9d.js"><link rel="prefetch" href="/assets/js/37.c37d1fcd.js"><link rel="prefetch" href="/assets/js/38.18cb3d3d.js"><link rel="prefetch" href="/assets/js/39.48e1c6c4.js"><link rel="prefetch" href="/assets/js/4.e5eca5cb.js"><link rel="prefetch" href="/assets/js/40.85b85b8c.js"><link rel="prefetch" href="/assets/js/41.94d3e608.js"><link rel="prefetch" href="/assets/js/42.4216a2f8.js"><link rel="prefetch" href="/assets/js/43.d1023d2d.js"><link rel="prefetch" href="/assets/js/44.8dad369c.js"><link rel="prefetch" href="/assets/js/45.1f6047dd.js"><link rel="prefetch" href="/assets/js/46.62047ba2.js"><link rel="prefetch" href="/assets/js/47.475f40f9.js"><link rel="prefetch" href="/assets/js/48.12680be5.js"><link rel="prefetch" href="/assets/js/49.86916cd4.js"><link rel="prefetch" href="/assets/js/5.b3497689.js"><link rel="prefetch" href="/assets/js/50.288200ab.js"><link rel="prefetch" href="/assets/js/51.1c466199.js"><link rel="prefetch" href="/assets/js/52.fb14af05.js"><link rel="prefetch" href="/assets/js/53.3ed02f0f.js"><link rel="prefetch" href="/assets/js/54.06d1f63e.js"><link rel="prefetch" href="/assets/js/55.7590d51b.js"><link rel="prefetch" href="/assets/js/56.b3863396.js"><link rel="prefetch" href="/assets/js/57.7aaa6cb3.js"><link rel="prefetch" href="/assets/js/58.165f498d.js"><link rel="prefetch" href="/assets/js/59.fa499230.js"><link rel="prefetch" href="/assets/js/6.48866410.js"><link rel="prefetch" href="/assets/js/60.696a6499.js"><link rel="prefetch" href="/assets/js/61.7671d3e8.js"><link rel="prefetch" href="/assets/js/62.91f9ddc6.js"><link rel="prefetch" href="/assets/js/63.c989977c.js"><link rel="prefetch" href="/assets/js/64.cb2c64af.js"><link rel="prefetch" href="/assets/js/65.7e0c0d20.js"><link rel="prefetch" href="/assets/js/66.b5061760.js"><link rel="prefetch" href="/assets/js/67.028ebe75.js"><link rel="prefetch" href="/assets/js/68.d568f33c.js"><link rel="prefetch" href="/assets/js/69.196c2e88.js"><link rel="prefetch" href="/assets/js/7.72c25d83.js"><link rel="prefetch" href="/assets/js/70.61be4c08.js"><link rel="prefetch" href="/assets/js/71.24e036f4.js"><link rel="prefetch" href="/assets/js/72.0338c90f.js"><link rel="prefetch" href="/assets/js/73.e4dc055e.js"><link rel="prefetch" href="/assets/js/74.b1068036.js"><link rel="prefetch" href="/assets/js/75.704a9c9a.js"><link rel="prefetch" href="/assets/js/76.132337fc.js"><link rel="prefetch" href="/assets/js/77.35975d59.js"><link rel="prefetch" href="/assets/js/78.23a67972.js"><link rel="prefetch" href="/assets/js/79.2cf3c8b6.js"><link rel="prefetch" href="/assets/js/8.5f339f67.js"><link rel="prefetch" href="/assets/js/80.83562ac2.js"><link rel="prefetch" href="/assets/js/81.c000f61a.js"><link rel="prefetch" href="/assets/js/82.7768b9ec.js"><link rel="prefetch" href="/assets/js/83.89341f9c.js"><link rel="prefetch" href="/assets/js/84.d7fe1e9a.js"><link rel="prefetch" href="/assets/js/85.a3dc42f1.js"><link rel="prefetch" href="/assets/js/86.850abc43.js"><link rel="prefetch" href="/assets/js/87.6dbca8f5.js"><link rel="prefetch" href="/assets/js/88.74cfb12c.js"><link rel="prefetch" href="/assets/js/89.309a0c9f.js"><link rel="prefetch" href="/assets/js/9.d49e2adf.js"><link rel="prefetch" href="/assets/js/90.71cfbbe7.js"><link rel="prefetch" href="/assets/js/91.b7929599.js"><link rel="prefetch" href="/assets/js/92.08d28986.js"><link rel="prefetch" href="/assets/js/93.87670190.js"><link rel="prefetch" href="/assets/js/94.6467e097.js"><link rel="prefetch" href="/assets/js/95.fb563355.js"><link rel="prefetch" href="/assets/js/96.dad15ec1.js"><link rel="prefetch" href="/assets/js/97.92df8bfe.js"><link rel="prefetch" href="/assets/js/98.1bc4c5cd.js"><link rel="prefetch" href="/assets/js/99.482f00a2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.986ab28c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Tech Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link router-link-active">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link router-link-active">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/technologies/" aria-current="page" class="sidebar-link">/technologies/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/network.webp"></span> <span>Networking</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technologies/networking/osi-model.html" class="sidebar-link">OSI Model</a></li><li><a href="/technologies/networking/tcp.html" class="sidebar-link">TCP Procol</a></li><li><a href="/technologies/networking/udp.html" class="sidebar-link">UDP Protocol</a></li><li><a href="/technologies/networking/http.html" class="sidebar-link">HTTP Protocol</a></li><li><a href="/technologies/networking/websocket.html" class="sidebar-link">WebSocket</a></li><li><a href="/technologies/networking/hsts.html" class="sidebar-link">HSTS</a></li><li><a href="/technologies/networking/dns.html" aria-current="page" class="active sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technologies/networking/dns.html#layers" class="sidebar-link">Layers</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/dns.html#new-approaches" class="sidebar-link">New Approaches</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/dns.html#source" class="sidebar-link">Source</a></li></ul></li><li><a href="/technologies/networking/sni.html" class="sidebar-link">Server Name Indication</a></li><li><a href="/technologies/networking/grpc.html" class="sidebar-link">gRPC</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/security.webp"></span> <span>Security</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/blockchain.webp"></span> <span>Blockchain</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/linux.webp"></span> <span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/kubernetes.webp"></span> <span>Kubernetes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/sql-server.webp"></span> <span>SQL Server</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/mongodb.webp"></span> <span>MongoDB</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/git.webp"></span> <span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/ansible.webp"></span> <span>Ansible</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/azure.webp"></span> <span>Azure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/gcp.webp"></span> <span>Google Cloud</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="frontmatter-title"><a href="#frontmatter-title" class="header-anchor">#</a> DNS</h1> <p>Here's a diagram of how DNS works:</p> <p><img src="/assets/img/dns.285b70d2.png" alt=""></p> <p>We assume that there is some internal DNS server that we're reaching out to
first. It could be a DNS server hosted on our gateway.</p> <p>The image presents the worst-case scenario, assuming that nothing was cached.</p> <ol><li>If the entry is in the DNS cache of the internal DNS server, and the TTL of
that entry has not expired, then the response is supplied immediately to the
client. Similarly, if the client is requesting an entry that's hosted on the
server in a zone file, the answer is supplied immediately to the client.</li> <li>If the entry is not in the cache of the internal DNS server, or if it is in
the cache but the TTL of that entry has expired, then the internal server
forwards the request to its upstream providers (often called forwarders) to
refresh the entry. If the query is in the cache of the forwarder, it will simply
return the answer. If this server has the authoritative name server for the
domain, it will simply query that host (skipping ahead in the process to Step
5).</li> <li>If the forwarder does not have the request in the cache, it will in turn
request upstream. In this case, though, it will likely query the root name
servers. The goal in this is to find the &quot;authoritative name server&quot; that has
the actual entries (in a zone file) for that domain. In this case, the query is
made to the root name servers for &quot;.com&quot;.</li> <li>The root name server will not return the actual answer, but will instead
return the authoritative name server for the top-level domain (TLD)—in this
case, for .com.</li> <li>After the forwarder gets this response, it updates its cache with that name
server entry, then makes the actual query against that server.</li> <li>The authoritative server for &quot;.com&quot; returns the authoritative DNS server for
&quot;example.com&quot;.</li> <li>The forwarder server then makes a request against this final authoritative
name server. 8. The authoritative name server for example.com returns the actual
query &quot;answer&quot; to the forwarder server.</li> <li>The forwarder name server caches that answer, then sends a reply back to your
internal name server.</li> <li>Your internal DNS server also caches that answer, then forwards it back to
the client. The client caches the request in its local cache, then passes the
requested information (the DNS response) to the application that requested it
(like a web browser)</li></ol> <h2 id="layers"><a href="#layers" class="header-anchor">#</a> Layers</h2> <p>Logically, there are various layers of DNS:</p> <ol><li>Local/Internal DNS</li> <li>External DNS (like <code>8.8.8.8</code>)</li> <li>Root Servers (<code>.</code>)</li> <li>TLD Servers (e.g., <code>.com</code>)</li> <li>Other Authoritative Servers</li></ol> <p>There are 13 Root Servers (in reality these are rather clusters than servers).</p> <h2 id="new-approaches"><a href="#new-approaches" class="header-anchor">#</a> New Approaches</h2> <p>DNS requests are made without encryption. That basically means that ISPs can
track the websited that you visit. There are two approaches to circumvent that:
DoH and DoT.</p> <h3 id="doh"><a href="#doh" class="header-anchor">#</a> DoH</h3> <p>DNS over HTTPS - it basically turns DNS servers into HTTP(S) servers listening
on 443 for DNS queries.</p> <h3 id="dot"><a href="#dot" class="header-anchor">#</a> DoT</h3> <p>DNS over TLS. It's the standard DNS, but encrypted with TLS.</p> <h2 id="source"><a href="#source" class="header-anchor">#</a> Source</h2> <ul><li><a href="https://www.packtpub.com/product/linux-for-networking-professionals/9781800202399" target="_blank" rel="noopener noreferrer">Linux for Networking
Professionals<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/technologies/networking/hsts.html" class="prev">
        HSTS
      </a></span> <span class="next"><a href="/technologies/networking/sni.html">
        Server Name Indication
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/30/2022, 6:42:35 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.8a08511c.js" defer></script><script src="/assets/js/2.e154a615.js" defer></script><script src="/assets/js/31.42571625.js" defer></script>
  </body>
</html>
