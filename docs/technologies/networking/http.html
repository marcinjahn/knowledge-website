<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP Protocol | Marcin Jahn | Technology Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="My personal knowledge base for all the IT-related topics">
    <meta property="og:url" content="/technologies/networking/http.html">
    <meta property="og:site_name" content="Marcin Jahn | Technology Notebook">
    <meta property="og:title" content="HTTP Protocol">
    <meta property="og:description" content="HTTP Protocol Simple Implementation HTTP is all about sending appropriately formatted messages over TCP (unless HTTP/3 is used). The simplest HTTP server below shows it quite well:">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Technology Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="white">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.78248196.css" as="style"><link rel="preload" href="/assets/js/app.1f3daf25.js" as="script"><link rel="preload" href="/assets/js/2.859bd0f8.js" as="script"><link rel="preload" href="/assets/js/116.93b01f06.js" as="script"><link rel="prefetch" href="/assets/js/10.492624e3.js"><link rel="prefetch" href="/assets/js/100.4863eb84.js"><link rel="prefetch" href="/assets/js/101.971a8abc.js"><link rel="prefetch" href="/assets/js/102.4a64520a.js"><link rel="prefetch" href="/assets/js/103.66c010d4.js"><link rel="prefetch" href="/assets/js/104.05daabb2.js"><link rel="prefetch" href="/assets/js/105.fced6911.js"><link rel="prefetch" href="/assets/js/106.f0c2937f.js"><link rel="prefetch" href="/assets/js/107.9e4f2124.js"><link rel="prefetch" href="/assets/js/108.35cf53e6.js"><link rel="prefetch" href="/assets/js/109.522bacf9.js"><link rel="prefetch" href="/assets/js/11.457002a9.js"><link rel="prefetch" href="/assets/js/110.94eaae3b.js"><link rel="prefetch" href="/assets/js/111.7a92b6c6.js"><link rel="prefetch" href="/assets/js/112.874a93d0.js"><link rel="prefetch" href="/assets/js/113.4b52e0e7.js"><link rel="prefetch" href="/assets/js/114.4702c623.js"><link rel="prefetch" href="/assets/js/115.85a60b64.js"><link rel="prefetch" href="/assets/js/117.6e12fc5c.js"><link rel="prefetch" href="/assets/js/118.3e5629ea.js"><link rel="prefetch" href="/assets/js/119.c0f7f5d5.js"><link rel="prefetch" href="/assets/js/12.f0db8451.js"><link rel="prefetch" href="/assets/js/120.54da667a.js"><link rel="prefetch" href="/assets/js/121.802cac9a.js"><link rel="prefetch" href="/assets/js/122.19824c5d.js"><link rel="prefetch" href="/assets/js/123.53b850ce.js"><link rel="prefetch" href="/assets/js/13.2d4d2efb.js"><link rel="prefetch" href="/assets/js/14.bb8e37ce.js"><link rel="prefetch" href="/assets/js/15.621ed2e9.js"><link rel="prefetch" href="/assets/js/16.11fbffb9.js"><link rel="prefetch" href="/assets/js/17.5dd495e5.js"><link rel="prefetch" href="/assets/js/18.70bcada4.js"><link rel="prefetch" href="/assets/js/19.4e46b10a.js"><link rel="prefetch" href="/assets/js/20.ee092c9b.js"><link rel="prefetch" href="/assets/js/21.115b1d02.js"><link rel="prefetch" href="/assets/js/22.760f9c80.js"><link rel="prefetch" href="/assets/js/23.188ab800.js"><link rel="prefetch" href="/assets/js/24.cd93aad3.js"><link rel="prefetch" href="/assets/js/25.70ffc5d2.js"><link rel="prefetch" href="/assets/js/26.d5b48f5b.js"><link rel="prefetch" href="/assets/js/27.d78fbfe7.js"><link rel="prefetch" href="/assets/js/28.eb4d1d6e.js"><link rel="prefetch" href="/assets/js/29.8debde2d.js"><link rel="prefetch" href="/assets/js/3.f58aa2db.js"><link rel="prefetch" href="/assets/js/30.faf769c9.js"><link rel="prefetch" href="/assets/js/31.125000da.js"><link rel="prefetch" href="/assets/js/32.fa41c4aa.js"><link rel="prefetch" href="/assets/js/33.7487efab.js"><link rel="prefetch" href="/assets/js/34.4974810c.js"><link rel="prefetch" href="/assets/js/35.6ec22e4e.js"><link rel="prefetch" href="/assets/js/36.85149ed9.js"><link rel="prefetch" href="/assets/js/37.d97ebc15.js"><link rel="prefetch" href="/assets/js/38.8bea259f.js"><link rel="prefetch" href="/assets/js/39.5b2f295f.js"><link rel="prefetch" href="/assets/js/4.95bb3c2b.js"><link rel="prefetch" href="/assets/js/40.542639da.js"><link rel="prefetch" href="/assets/js/41.a0931265.js"><link rel="prefetch" href="/assets/js/42.855bf39d.js"><link rel="prefetch" href="/assets/js/43.4d91a62b.js"><link rel="prefetch" href="/assets/js/44.b3f2bc5d.js"><link rel="prefetch" href="/assets/js/45.4cae8bc2.js"><link rel="prefetch" href="/assets/js/46.f294f11d.js"><link rel="prefetch" href="/assets/js/47.be59bad4.js"><link rel="prefetch" href="/assets/js/48.0d9a97a8.js"><link rel="prefetch" href="/assets/js/49.7d79b848.js"><link rel="prefetch" href="/assets/js/5.361309d8.js"><link rel="prefetch" href="/assets/js/50.0de8298a.js"><link rel="prefetch" href="/assets/js/51.42439cdc.js"><link rel="prefetch" href="/assets/js/52.1a79c7ca.js"><link rel="prefetch" href="/assets/js/53.fde99b71.js"><link rel="prefetch" href="/assets/js/54.cfb89c63.js"><link rel="prefetch" href="/assets/js/55.4f50f169.js"><link rel="prefetch" href="/assets/js/56.8f9c3283.js"><link rel="prefetch" href="/assets/js/57.95f6eef2.js"><link rel="prefetch" href="/assets/js/58.6f216255.js"><link rel="prefetch" href="/assets/js/59.d84a7a59.js"><link rel="prefetch" href="/assets/js/6.12637fb2.js"><link rel="prefetch" href="/assets/js/60.8b4f398a.js"><link rel="prefetch" href="/assets/js/61.06ae4327.js"><link rel="prefetch" href="/assets/js/62.b76d460d.js"><link rel="prefetch" href="/assets/js/63.9a5fbfcb.js"><link rel="prefetch" href="/assets/js/64.1abb4d7e.js"><link rel="prefetch" href="/assets/js/65.ce583fb7.js"><link rel="prefetch" href="/assets/js/66.ad14e9b5.js"><link rel="prefetch" href="/assets/js/67.f141a68a.js"><link rel="prefetch" href="/assets/js/68.b5e4c739.js"><link rel="prefetch" href="/assets/js/69.3ce5db93.js"><link rel="prefetch" href="/assets/js/7.ed62b6c5.js"><link rel="prefetch" href="/assets/js/70.0cc4db19.js"><link rel="prefetch" href="/assets/js/71.f72f84c1.js"><link rel="prefetch" href="/assets/js/72.04c7a5da.js"><link rel="prefetch" href="/assets/js/73.ff09bded.js"><link rel="prefetch" href="/assets/js/74.0b14e68d.js"><link rel="prefetch" href="/assets/js/75.64ec73a9.js"><link rel="prefetch" href="/assets/js/76.9bb3b9a8.js"><link rel="prefetch" href="/assets/js/77.a89bcb93.js"><link rel="prefetch" href="/assets/js/78.8e80cb35.js"><link rel="prefetch" href="/assets/js/79.2ac3ac37.js"><link rel="prefetch" href="/assets/js/8.28809440.js"><link rel="prefetch" href="/assets/js/80.ce822f44.js"><link rel="prefetch" href="/assets/js/81.ed1029c8.js"><link rel="prefetch" href="/assets/js/82.7ef77e40.js"><link rel="prefetch" href="/assets/js/83.d84911f7.js"><link rel="prefetch" href="/assets/js/84.adb42b54.js"><link rel="prefetch" href="/assets/js/85.778473bf.js"><link rel="prefetch" href="/assets/js/86.c70dbbc5.js"><link rel="prefetch" href="/assets/js/87.ee6e1f23.js"><link rel="prefetch" href="/assets/js/88.66aecb6b.js"><link rel="prefetch" href="/assets/js/89.1c14c4ec.js"><link rel="prefetch" href="/assets/js/9.e6f6ad0e.js"><link rel="prefetch" href="/assets/js/90.c366fd7b.js"><link rel="prefetch" href="/assets/js/91.39ff6938.js"><link rel="prefetch" href="/assets/js/92.8997ec8c.js"><link rel="prefetch" href="/assets/js/93.a212a3c4.js"><link rel="prefetch" href="/assets/js/94.8d7079e9.js"><link rel="prefetch" href="/assets/js/95.ebd5dab5.js"><link rel="prefetch" href="/assets/js/96.d125875a.js"><link rel="prefetch" href="/assets/js/97.68e14307.js"><link rel="prefetch" href="/assets/js/98.abe64913.js"><link rel="prefetch" href="/assets/js/99.4be1f28c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.78248196.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Technology Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link">
  Programming
</a></div><div class="nav-item"><a href="/dev-tools/" class="nav-link">
  Tools and Infrastructure
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link router-link-active">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link">
  Programming
</a></div><div class="nav-item"><a href="/dev-tools/" class="nav-link">
  Tools and Infrastructure
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link router-link-active">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/technologies/" aria-current="page" class="sidebar-link">/technologies/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Web Protocols</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technologies/networking/osi-model.html" class="sidebar-link">OSI Model</a></li><li><a href="/technologies/networking/tcp.html" class="sidebar-link">TCP Procol</a></li><li><a href="/technologies/networking/udp.html" class="sidebar-link">UDP Protocol</a></li><li><a href="/technologies/networking/http.html" aria-current="page" class="active sidebar-link">HTTP Protocol</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technologies/networking/http.html#simple-implementation" class="sidebar-link">Simple Implementation</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/http.html#versions" class="sidebar-link">Versions</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/http.html#browser-storage" class="sidebar-link">Browser Storage</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/http.html#proxying" class="sidebar-link">Proxying</a></li><li class="sidebar-sub-header"><a href="/technologies/networking/http.html#enforcing-https" class="sidebar-link">Enforcing HTTPS</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Security</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Blockchain</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="http-protocol"><a href="#http-protocol" class="header-anchor">#</a> HTTP Protocol</h1> <h2 id="simple-implementation"><a href="#simple-implementation" class="header-anchor">#</a> Simple Implementation</h2> <p>HTTP is all about sending appropriately formatted messages over TCP (unless
HTTP/3 is used). The simplest HTTP server below shows it quite well:</p> <p>https://medium.com/from-the-scratch/http-server-what-do-you-need-to-know-to-build-a-simple-http-server-from-scratch-d1ef8945e4fa</p> <h2 id="versions"><a href="#versions" class="header-anchor">#</a> Versions</h2> <p><strong>HTTP/1.0</strong> was establishing a separate TCP connection per each request -
expensive - every CSS, image, etc. of a website had to be fetched through a
separate TCP connection.</p> <p><strong>HTTP/1.1</strong> introduced:</p> <ul><li><code>Host</code> header containing the target domain. Without this, proxies could not
work (they wouldn't know where to send the request)</li> <li><code>keep-alive</code> header, which reused a connection when loading content
(<em>persisted TCP connection</em>). The server understands it and keeps the TCP
connection open</li> <li><code>ETag</code> caching.</li> <li><em>Streaming</em> of content.</li></ul> <p><strong>HTTP/2</strong> introduced:</p> <ul><li>compression</li> <li>multiplexing - client joins his requests into one request</li> <li>always HTTPS (TLS)</li> <li>ALPN - negotiates protocol during the TLS handshake</li></ul> <p><strong>HTTP/3</strong> introduced:</p> <ul><li>uses QUIC (UDP with Congestion control) instead of TCP, making the amount of
communication much smaller, resulting in reduced latencies.</li></ul> <h2 id="browser-storage"><a href="#browser-storage" class="header-anchor">#</a> Browser Storage</h2> <p><img src="https://i.imgur.com/UXLpHD2.png" alt=""></p> <p>The main diference is that cookies are sent to servers, while localStorage and
sessionStorage stay on the client only. Also, localStorage stays in forever.</p> <h2 id="proxying"><a href="#proxying" class="header-anchor">#</a> Proxying</h2> <h3 id="http-proxy"><a href="#http-proxy" class="header-anchor">#</a> HTTP Proxy</h3> <p>It needs to be configured on the client. When I send any HTTP request, it's
going to be modified in a layer 3. The IP address will be set to the IP address
of the proxy. The proxy will receive my request (on TCP connection 1), and by
inspecting the layer 7 data it will see what request I wanted to make. It will
create another TCP connection (with the target server), get the data, and send
it back to me (on TCP connection 1). The target server does not know that the
client was behind a proxy.</p> <p>Reference: https://www.youtube.com/watch?v=x4E4mbobGEc</p> <h3 id="https-proxy"><a href="#https-proxy" class="header-anchor">#</a> HTTPS Proxy</h3> <p>The proxy needs to see what domain we want to access. This information is
decrypted though. To go around that, the proxy needs to offer TLS termination
and provide a certificate that the client needs to trust.</p> <p><img src="https://i.imgur.com/vdj2Ebz.png" alt=""></p> <p>Reference: https://www.youtube.com/watch?v=PAJ5kK50qp8</p> <h3 id="http-connect-proxy"><a href="#http-connect-proxy" class="header-anchor">#</a> HTTP CONNECT proxy</h3> <ol><li>First, a client sends HTTP CONNECT to the proxy with domain of the target
server.</li> <li>The proxy establishes a TCP connection with the target server and returns
success to the client</li> <li>For any packet sent from the client to the proxy, proxy hanges the source IP
to itself and sends this packet via the previouslu established TCP connection
to the target server.</li> <li>Any response from the target server gets its source IP modified to the
proxy's IP and sent back to the client.</li></ol> <p>The communication is end-to-end, the proxy does not see the encrypted content.
Te proxy knows only the domain we're communicating with.</p> <p>Proxies may be chained, so that a proxy has its own proxy:</p> <p><img src="https://i.imgur.com/J7mOhkO.png" alt=""></p> <h2 id="enforcing-https"><a href="#enforcing-https" class="header-anchor">#</a> Enforcing HTTPS</h2> <p>There are at least two ways to enforce HTTPS:</p> <ul><li>Redirect from HTTP to HTTPS on your server</li> <li>Use HSTS - it's a header that informs the browser to ALWAYS use HTTPS when
reaching the app.</li></ul> <div class="custom-block tip"><p class="custom-block-title">ASP.NET Core</p> <p>ASP.NET Core has built-in middleware for both of the points above.</p></div> <p>HSTS should be used only if we do not plan to make use of HTTP in the app.
Otherwise we can make it impossible for the users to reach the HTTP endpoints.</p> <p>HSTS should not be used in development.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/technologies/networking/udp.html" class="prev">
        UDP Protocol
      </a></span> <span class="next"><a href="/technologies/security/oauth2/sender-constraint.html">
        Sender Constraint
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/20/2022, 6:37:38 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1f3daf25.js" defer></script><script src="/assets/js/2.859bd0f8.js" defer></script><script src="/assets/js/116.93b01f06.js" defer></script>
  </body>
</html>
