<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Compilation | Marcin Jahn | Technology Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="How we get from C program to machine code">
    <meta property="og:url" content="/programming/c/compilation.html">
    <meta property="og:site_name" content="Marcin Jahn | Technology Notebook">
    <meta property="og:title" content="Compilation">
    <meta property="og:description" content="How we get from C program to machine code">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Technology Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="white">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.cfa8f008.css" as="style"><link rel="preload" href="/assets/js/app.60e5ef95.js" as="script"><link rel="preload" href="/assets/js/2.509aea98.js" as="script"><link rel="preload" href="/assets/js/40.f874c287.js" as="script"><link rel="prefetch" href="/assets/js/10.2f628158.js"><link rel="prefetch" href="/assets/js/100.e8d00495.js"><link rel="prefetch" href="/assets/js/101.5412944b.js"><link rel="prefetch" href="/assets/js/102.feadcc1e.js"><link rel="prefetch" href="/assets/js/103.385d5540.js"><link rel="prefetch" href="/assets/js/104.c238db1c.js"><link rel="prefetch" href="/assets/js/105.21e02e29.js"><link rel="prefetch" href="/assets/js/106.ae0efb5f.js"><link rel="prefetch" href="/assets/js/107.accf83ac.js"><link rel="prefetch" href="/assets/js/108.112902bd.js"><link rel="prefetch" href="/assets/js/109.809500d4.js"><link rel="prefetch" href="/assets/js/11.e89ffa34.js"><link rel="prefetch" href="/assets/js/110.37066cd6.js"><link rel="prefetch" href="/assets/js/111.70af5fb8.js"><link rel="prefetch" href="/assets/js/112.d5151658.js"><link rel="prefetch" href="/assets/js/113.63af056f.js"><link rel="prefetch" href="/assets/js/114.3a63b61c.js"><link rel="prefetch" href="/assets/js/115.b232f246.js"><link rel="prefetch" href="/assets/js/116.bf492c77.js"><link rel="prefetch" href="/assets/js/117.dcad6969.js"><link rel="prefetch" href="/assets/js/118.b05eda88.js"><link rel="prefetch" href="/assets/js/119.39f2f904.js"><link rel="prefetch" href="/assets/js/12.d6e4a587.js"><link rel="prefetch" href="/assets/js/120.45dbe6a5.js"><link rel="prefetch" href="/assets/js/121.9941b457.js"><link rel="prefetch" href="/assets/js/122.fc4f2ff3.js"><link rel="prefetch" href="/assets/js/123.c3cdb452.js"><link rel="prefetch" href="/assets/js/124.ae57edd4.js"><link rel="prefetch" href="/assets/js/125.80a7f80f.js"><link rel="prefetch" href="/assets/js/126.826ae28d.js"><link rel="prefetch" href="/assets/js/127.fe0c8441.js"><link rel="prefetch" href="/assets/js/128.c95d889d.js"><link rel="prefetch" href="/assets/js/129.acdbd954.js"><link rel="prefetch" href="/assets/js/13.f330b497.js"><link rel="prefetch" href="/assets/js/130.3413d67e.js"><link rel="prefetch" href="/assets/js/131.bce246a4.js"><link rel="prefetch" href="/assets/js/132.3c37f311.js"><link rel="prefetch" href="/assets/js/133.44e32f05.js"><link rel="prefetch" href="/assets/js/134.a6e4d78f.js"><link rel="prefetch" href="/assets/js/135.d7998fb2.js"><link rel="prefetch" href="/assets/js/136.c31601e7.js"><link rel="prefetch" href="/assets/js/137.4489b00b.js"><link rel="prefetch" href="/assets/js/138.8c6b88b7.js"><link rel="prefetch" href="/assets/js/139.2cffbefb.js"><link rel="prefetch" href="/assets/js/14.71349fad.js"><link rel="prefetch" href="/assets/js/140.07b8552f.js"><link rel="prefetch" href="/assets/js/15.7bf51c0f.js"><link rel="prefetch" href="/assets/js/16.7d676b66.js"><link rel="prefetch" href="/assets/js/17.07b6763a.js"><link rel="prefetch" href="/assets/js/18.f043472f.js"><link rel="prefetch" href="/assets/js/19.17683864.js"><link rel="prefetch" href="/assets/js/20.b384583d.js"><link rel="prefetch" href="/assets/js/21.3aced90b.js"><link rel="prefetch" href="/assets/js/22.7f6dda29.js"><link rel="prefetch" href="/assets/js/23.ca4f6e56.js"><link rel="prefetch" href="/assets/js/24.896bd9f6.js"><link rel="prefetch" href="/assets/js/25.c329a954.js"><link rel="prefetch" href="/assets/js/26.29ffd1e2.js"><link rel="prefetch" href="/assets/js/27.77aece92.js"><link rel="prefetch" href="/assets/js/28.f1c31003.js"><link rel="prefetch" href="/assets/js/29.f9e91935.js"><link rel="prefetch" href="/assets/js/3.61338c2e.js"><link rel="prefetch" href="/assets/js/30.03b95d9f.js"><link rel="prefetch" href="/assets/js/31.c3ddb45e.js"><link rel="prefetch" href="/assets/js/32.ec5f1b8d.js"><link rel="prefetch" href="/assets/js/33.8791656b.js"><link rel="prefetch" href="/assets/js/34.506b3ff9.js"><link rel="prefetch" href="/assets/js/35.c404fcfe.js"><link rel="prefetch" href="/assets/js/36.e1836413.js"><link rel="prefetch" href="/assets/js/37.f71813e6.js"><link rel="prefetch" href="/assets/js/38.4343e12d.js"><link rel="prefetch" href="/assets/js/39.86b5c2db.js"><link rel="prefetch" href="/assets/js/4.cb63b922.js"><link rel="prefetch" href="/assets/js/41.9c247d6f.js"><link rel="prefetch" href="/assets/js/42.8d0f5758.js"><link rel="prefetch" href="/assets/js/43.a5721682.js"><link rel="prefetch" href="/assets/js/44.d660c752.js"><link rel="prefetch" href="/assets/js/45.3465f333.js"><link rel="prefetch" href="/assets/js/46.cd3c682f.js"><link rel="prefetch" href="/assets/js/47.114fda21.js"><link rel="prefetch" href="/assets/js/48.c1af4594.js"><link rel="prefetch" href="/assets/js/49.8b755298.js"><link rel="prefetch" href="/assets/js/5.7d01b04b.js"><link rel="prefetch" href="/assets/js/50.38fc6c56.js"><link rel="prefetch" href="/assets/js/51.f984821b.js"><link rel="prefetch" href="/assets/js/52.a0641e02.js"><link rel="prefetch" href="/assets/js/53.3d61bb74.js"><link rel="prefetch" href="/assets/js/54.f08e887f.js"><link rel="prefetch" href="/assets/js/55.2f445ff2.js"><link rel="prefetch" href="/assets/js/56.8d4e9474.js"><link rel="prefetch" href="/assets/js/57.402c1181.js"><link rel="prefetch" href="/assets/js/58.c8406587.js"><link rel="prefetch" href="/assets/js/59.d2665ee7.js"><link rel="prefetch" href="/assets/js/6.2bab3d21.js"><link rel="prefetch" href="/assets/js/60.88008ac1.js"><link rel="prefetch" href="/assets/js/61.c898b47f.js"><link rel="prefetch" href="/assets/js/62.c981d2b7.js"><link rel="prefetch" href="/assets/js/63.a58b38a0.js"><link rel="prefetch" href="/assets/js/64.dcf71fdb.js"><link rel="prefetch" href="/assets/js/65.824b3395.js"><link rel="prefetch" href="/assets/js/66.cf189a7a.js"><link rel="prefetch" href="/assets/js/67.55781b9b.js"><link rel="prefetch" href="/assets/js/68.beae0c8b.js"><link rel="prefetch" href="/assets/js/69.e0a89937.js"><link rel="prefetch" href="/assets/js/7.f9d1bfa8.js"><link rel="prefetch" href="/assets/js/70.30c3b7ea.js"><link rel="prefetch" href="/assets/js/71.809f7c73.js"><link rel="prefetch" href="/assets/js/72.57a698f6.js"><link rel="prefetch" href="/assets/js/73.b53894ad.js"><link rel="prefetch" href="/assets/js/74.63ed65cc.js"><link rel="prefetch" href="/assets/js/75.c0d4c45e.js"><link rel="prefetch" href="/assets/js/76.6b2c13c6.js"><link rel="prefetch" href="/assets/js/77.1202d861.js"><link rel="prefetch" href="/assets/js/78.5b3d3113.js"><link rel="prefetch" href="/assets/js/79.1024bda7.js"><link rel="prefetch" href="/assets/js/8.86a45292.js"><link rel="prefetch" href="/assets/js/80.bba3c10f.js"><link rel="prefetch" href="/assets/js/81.53080171.js"><link rel="prefetch" href="/assets/js/82.c90c52c9.js"><link rel="prefetch" href="/assets/js/83.5f963fe3.js"><link rel="prefetch" href="/assets/js/84.7b1334d1.js"><link rel="prefetch" href="/assets/js/85.850513de.js"><link rel="prefetch" href="/assets/js/86.b0556230.js"><link rel="prefetch" href="/assets/js/87.f907eded.js"><link rel="prefetch" href="/assets/js/88.b8e159ae.js"><link rel="prefetch" href="/assets/js/89.bfd2bba0.js"><link rel="prefetch" href="/assets/js/9.4e5349e1.js"><link rel="prefetch" href="/assets/js/90.722dea1c.js"><link rel="prefetch" href="/assets/js/91.81e3f5ce.js"><link rel="prefetch" href="/assets/js/92.4892370b.js"><link rel="prefetch" href="/assets/js/93.b752884b.js"><link rel="prefetch" href="/assets/js/94.cfed9643.js"><link rel="prefetch" href="/assets/js/95.88cff3d1.js"><link rel="prefetch" href="/assets/js/96.7506258a.js"><link rel="prefetch" href="/assets/js/97.98c8455f.js"><link rel="prefetch" href="/assets/js/98.e6bd0a5a.js"><link rel="prefetch" href="/assets/js/99.4ebe7885.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cfa8f008.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Technology Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/c/compilation.html" aria-current="page" class="active sidebar-link">Compilation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/c/compilation.html#preprocessor" class="sidebar-link">Preprocessor</a></li><li class="sidebar-sub-header"><a href="/programming/c/compilation.html#compiler" class="sidebar-link">Compiler</a></li><li class="sidebar-sub-header"><a href="/programming/c/compilation.html#assembler" class="sidebar-link">Assembler</a></li><li class="sidebar-sub-header"><a href="/programming/c/compilation.html#linker" class="sidebar-link">Linker</a></li></ul></li><li><a href="/programming/c/pointers.html" class="sidebar-link">Pointers</a></li><li><a href="/programming/c/strings.html" class="sidebar-link">Strings</a></li><li><a href="/programming/c/dynamic-memory.html" class="sidebar-link">Dynamic Memory</a></li><li><a href="/programming/c/argc-argv-visualized.html" class="sidebar-link">argc and argv Visualization</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="compilation"><a href="#compilation" class="header-anchor">#</a> Compilation</h1> <p>Our source files go through the following process:</p> <ol><li>Preprocessor</li> <li>Compiler</li> <li>Assembler</li> <li>Linker</li></ol> <p>Let's explain the process based on a simple solution:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="main.cpp" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;source.hpp&quot;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></section> <section aria-hidden="true" id="add.cpp" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></section> <section aria-hidden="true" id="add.hpp" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></section></div></div> <p>We can compile the app with:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>g++ main.cpp add.cpp

<span class="token comment"># or to change the binary name</span>
g++ main.cpp add.cpp -o program
</code></pre></div><p>The result is an executable file <code>a.out</code>.</p> <h2 id="preprocessor"><a href="#preprocessor" class="header-anchor">#</a> Preprocessor</h2> <p>The first step when compiling our program is the <strong>Preprocessing</strong>. It handles
all the lines that start with the <code>#</code> (e.g., <code>#include</code> or <code>#if</code>).</p> <p>To get the output of the preprocessor, we can execute:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>gcc++ -E main.cpp
</code></pre></div><p>Here's what we get on stdout:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code># <span class="token number">1</span> <span class="token string">&quot;main.cpp&quot;</span>
# <span class="token number">1</span> <span class="token string">&quot;&lt;built-in&gt;&quot;</span>
# <span class="token number">1</span> <span class="token string">&quot;&lt;command-line&gt;&quot;</span>
# <span class="token number">1</span> <span class="token string">&quot;/usr/include/stdc-predef.h&quot;</span> <span class="token number">1</span> <span class="token number">3</span> <span class="token number">4</span>
# <span class="token number">1</span> <span class="token string">&quot;&lt;command-line&gt;&quot;</span> <span class="token number">2</span>
# <span class="token number">1</span> <span class="token string">&quot;main.cpp&quot;</span>
# <span class="token number">1</span> <span class="token string">&quot;source.hpp&quot;</span> <span class="token number">1</span>
<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
# <span class="token number">2</span> <span class="token string">&quot;main.cpp&quot;</span> <span class="token number">2</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If we included some common library like <em>iostream</em>, our file would become huge
after the preprocessing stage.</p> <p>What preprocessor did in this case was just including the content of <code>add.hpp</code>
directly into <code>main.cpp</code>.</p> <h2 id="compiler"><a href="#compiler" class="header-anchor">#</a> Compiler</h2> <p>The result of preprocessing is handed over to the <strong>Compiler</strong>. Compiler
analyzes the text of the code and builds a tree (like AST - Abstract Syntaxt
Tree).</p> <p>We can dump out AST with:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>g++ -fdump-tree-all-graph -g main.cpp add.cpp
</code></pre></div><p>The resulting <code>.dot</code> files can be viewed.</p> <hr> <p>The next step of the compilation is the generation of the Assemby code.
Here' how we can generate Assembly code:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>g++ -S add.cpp
</code></pre></div><p>Here's the resulting <code>add.s</code> file:</p> <div class="language-asm extra-class"><pre class="language-text"><code>	.arch armv8-a
	.file	&quot;add.cpp&quot;
	.text
	.align	2
	.global	_Z3addii
	.type	_Z3addii, %function
_Z3addii:
.LFB0:
	.cfi_startproc
	sub	sp, sp, #16
	.cfi_def_cfa_offset 16
	str	w0, [sp, 12]
	str	w1, [sp, 8]
	ldr	w1, [sp, 12]
	ldr	w0, [sp, 8]
	add	w0, w1, w0
	add	sp, sp, 16
	.cfi_def_cfa_offset 0
	ret
	.cfi_endproc
.LFE0:
	.size	_Z3addii, .-_Z3addii
	.ident	&quot;GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0&quot;
	.section	.note.GNU-stack,&quot;&quot;,@progbits
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>This code was generated on an ARM64 machine.</p></div> <h2 id="assembler"><a href="#assembler" class="header-anchor">#</a> Assembler</h2> <p>We can generate object files from our source code with:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>g++ -c main.c
g++ -c add.c
</code></pre></div><p>It will produce <code>main.o</code> and <code>add.o</code> files. These are blobs of machine code.
They need to be joined together (via the Linker) in a proper way to have the
final executable.</p> <p>We can explore what's inside of the <code>.o</code> files with the <strong>objdump</strong> command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>objdump -t add.o
</code></pre></div><p>The result is:</p> <div class="language- extra-class"><pre class="language-text"><code>add.o:     file format elf64-littleaarch64

SYMBOL TABLE:
0000000000000000 l    df *ABS*	0000000000000000 add.cpp
0000000000000000 l    d  .text	0000000000000000 .text
0000000000000000 l    d  .data	0000000000000000 .data
0000000000000000 l    d  .bss	0000000000000000 .bss
0000000000000000 l    d  .note.GNU-stack	0000000000000000 .note.GNU-stack
0000000000000000 l    d  .eh_frame	0000000000000000 .eh_frame
0000000000000000 l    d  .comment	0000000000000000 .comment
0000000000000000 g     F .text	0000000000000020 _Z3addii
</code></pre></div><p>The last line lists our function <code>add</code>.</p> <h2 id="linker"><a href="#linker" class="header-anchor">#</a> Linker</h2> <p>Here's how to link the object files into an executable:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>g++ main.o source.o -o program <span class="token comment"># results in a.out</span>
</code></pre></div><p>Linker &quot;glues&quot; together the <code>.o</code> files. It also can link dynamic libraries
(<code>.so</code> files). An example of it could be &quot;iostream&quot;.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;add.hpp&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this program, I'm including &quot;iostream&quot; to make use of the <code>cout</code> function.</p> <p>After compilation, we can have a look at the dynamic libraries being linked to
our program:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ldd a.out
</code></pre></div><p>The result is:</p> <div class="language- extra-class"><pre class="language-text"><code>linux-vdso.so.1 (0x0000ffff8ff98000)
libstdc++.so.6 =&gt; /lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000ffff8fd71000)
libc.so.6 =&gt; /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffff8fbfe000)
libm.so.6 =&gt; /lib/aarch64-linux-gnu/libm.so.6 (0x0000ffff8fb54000)
/lib/ld-linux-aarch64.so.1 (0x0000ffff8ff68000)
libgcc_s.so.1 =&gt; /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000ffff8fb30000)
</code></pre></div><p>::: Other OSs
The <code>.so</code> files are Linux dynamic libraries. Windows uses <code>.dll</code>, and macOS uses
<code>.dylib</code>.
:::</p> <p>When compiling programs, we can specify expkicitly the dynamic libraries that we
want to link, with the <code>-l</code> flag in g++.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/rust/tips.html" class="prev">
        Tips
      </a></span> <span class="next"><a href="/programming/c/pointers.html">
        Pointers
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/8/2022, 6:48:56 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.60e5ef95.js" defer></script><script src="/assets/js/2.509aea98.js" defer></script><script src="/assets/js/40.f874c287.js" defer></script>
  </body>
</html>
