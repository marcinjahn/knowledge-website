<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP | Marcin Jahn | Tech Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="HTTP requests in Angular SPA framework - senidng requests to Web API servers">
    <meta property="og:url" content="/programming/angular/http.html">
    <meta property="og:site_name" content="Marcin Jahn | Tech Notebook">
    <meta property="og:title" content="HTTP">
    <meta property="og:description" content="HTTP requests in Angular SPA framework - senidng requests to Web API servers">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Tech Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="#7D84B2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.907785b2.css" as="style"><link rel="preload" href="/assets/js/app.c20b4647.js" as="script"><link rel="preload" href="/assets/js/2.e154a615.js" as="script"><link rel="preload" href="/assets/js/48.fb50793f.js" as="script"><link rel="prefetch" href="/assets/js/10.0ce3faf0.js"><link rel="prefetch" href="/assets/js/100.0b594656.js"><link rel="prefetch" href="/assets/js/101.94166f8d.js"><link rel="prefetch" href="/assets/js/102.5821d1b4.js"><link rel="prefetch" href="/assets/js/103.ca4d0878.js"><link rel="prefetch" href="/assets/js/104.cb42ead2.js"><link rel="prefetch" href="/assets/js/105.8b86cebe.js"><link rel="prefetch" href="/assets/js/106.765b8ee8.js"><link rel="prefetch" href="/assets/js/107.97359580.js"><link rel="prefetch" href="/assets/js/108.337251ac.js"><link rel="prefetch" href="/assets/js/109.becf6069.js"><link rel="prefetch" href="/assets/js/11.ed94f7d2.js"><link rel="prefetch" href="/assets/js/110.31a65d14.js"><link rel="prefetch" href="/assets/js/111.0bfdc3b5.js"><link rel="prefetch" href="/assets/js/112.77af1d97.js"><link rel="prefetch" href="/assets/js/113.20468e1a.js"><link rel="prefetch" href="/assets/js/114.6723ad9b.js"><link rel="prefetch" href="/assets/js/115.5574324f.js"><link rel="prefetch" href="/assets/js/116.a220f9ed.js"><link rel="prefetch" href="/assets/js/117.2eec5e30.js"><link rel="prefetch" href="/assets/js/118.5f9daa5f.js"><link rel="prefetch" href="/assets/js/119.31db1bcb.js"><link rel="prefetch" href="/assets/js/12.1cc3c42f.js"><link rel="prefetch" href="/assets/js/120.b9326b2d.js"><link rel="prefetch" href="/assets/js/121.b2b3d83e.js"><link rel="prefetch" href="/assets/js/122.ebcdaf4e.js"><link rel="prefetch" href="/assets/js/123.1a648da1.js"><link rel="prefetch" href="/assets/js/124.f27fa1fe.js"><link rel="prefetch" href="/assets/js/125.966a73da.js"><link rel="prefetch" href="/assets/js/126.82cb67b7.js"><link rel="prefetch" href="/assets/js/127.4112b0ee.js"><link rel="prefetch" href="/assets/js/128.d19d3f47.js"><link rel="prefetch" href="/assets/js/129.7ba20770.js"><link rel="prefetch" href="/assets/js/13.d481e398.js"><link rel="prefetch" href="/assets/js/130.7d46145b.js"><link rel="prefetch" href="/assets/js/131.e7de7278.js"><link rel="prefetch" href="/assets/js/132.cae5bf78.js"><link rel="prefetch" href="/assets/js/133.8a8b0aba.js"><link rel="prefetch" href="/assets/js/134.dece4921.js"><link rel="prefetch" href="/assets/js/135.042a4f69.js"><link rel="prefetch" href="/assets/js/136.780fcb84.js"><link rel="prefetch" href="/assets/js/137.e85989ba.js"><link rel="prefetch" href="/assets/js/138.9b68d2f6.js"><link rel="prefetch" href="/assets/js/139.737be3aa.js"><link rel="prefetch" href="/assets/js/14.ab8e1dcc.js"><link rel="prefetch" href="/assets/js/140.65a37c4b.js"><link rel="prefetch" href="/assets/js/141.3f11275c.js"><link rel="prefetch" href="/assets/js/142.78a4cc71.js"><link rel="prefetch" href="/assets/js/143.41e3fc87.js"><link rel="prefetch" href="/assets/js/144.5ef2bea2.js"><link rel="prefetch" href="/assets/js/145.701b9ddc.js"><link rel="prefetch" href="/assets/js/146.00cd2e82.js"><link rel="prefetch" href="/assets/js/147.360b46c7.js"><link rel="prefetch" href="/assets/js/148.35b59b78.js"><link rel="prefetch" href="/assets/js/149.d32f8895.js"><link rel="prefetch" href="/assets/js/15.89e1dd21.js"><link rel="prefetch" href="/assets/js/150.c1a6cf14.js"><link rel="prefetch" href="/assets/js/151.1b6d0ad8.js"><link rel="prefetch" href="/assets/js/152.4c3daec7.js"><link rel="prefetch" href="/assets/js/153.f45d102f.js"><link rel="prefetch" href="/assets/js/154.f84e6250.js"><link rel="prefetch" href="/assets/js/155.0c18d5af.js"><link rel="prefetch" href="/assets/js/156.aa011b80.js"><link rel="prefetch" href="/assets/js/157.b7fc0356.js"><link rel="prefetch" href="/assets/js/158.38e06e68.js"><link rel="prefetch" href="/assets/js/159.954b08c0.js"><link rel="prefetch" href="/assets/js/16.2a55624c.js"><link rel="prefetch" href="/assets/js/160.3d168603.js"><link rel="prefetch" href="/assets/js/161.38648dda.js"><link rel="prefetch" href="/assets/js/162.21aacb2c.js"><link rel="prefetch" href="/assets/js/17.0833a4ad.js"><link rel="prefetch" href="/assets/js/18.6ff2dd32.js"><link rel="prefetch" href="/assets/js/19.cf1af818.js"><link rel="prefetch" href="/assets/js/20.c38fc183.js"><link rel="prefetch" href="/assets/js/21.47d88465.js"><link rel="prefetch" href="/assets/js/22.a63cf8db.js"><link rel="prefetch" href="/assets/js/23.170c9854.js"><link rel="prefetch" href="/assets/js/24.ae804337.js"><link rel="prefetch" href="/assets/js/25.a521e5a8.js"><link rel="prefetch" href="/assets/js/26.77e7e49f.js"><link rel="prefetch" href="/assets/js/27.a5ea7b41.js"><link rel="prefetch" href="/assets/js/28.ee118f89.js"><link rel="prefetch" href="/assets/js/29.fcefebb1.js"><link rel="prefetch" href="/assets/js/3.54e9968c.js"><link rel="prefetch" href="/assets/js/30.70031726.js"><link rel="prefetch" href="/assets/js/31.55f84ea9.js"><link rel="prefetch" href="/assets/js/32.3b90ff2a.js"><link rel="prefetch" href="/assets/js/33.e414a879.js"><link rel="prefetch" href="/assets/js/34.1bec9902.js"><link rel="prefetch" href="/assets/js/35.a682d85c.js"><link rel="prefetch" href="/assets/js/36.2c3f8f9d.js"><link rel="prefetch" href="/assets/js/37.c37d1fcd.js"><link rel="prefetch" href="/assets/js/38.18cb3d3d.js"><link rel="prefetch" href="/assets/js/39.48e1c6c4.js"><link rel="prefetch" href="/assets/js/4.03a19f22.js"><link rel="prefetch" href="/assets/js/40.85b85b8c.js"><link rel="prefetch" href="/assets/js/41.94d3e608.js"><link rel="prefetch" href="/assets/js/42.4216a2f8.js"><link rel="prefetch" href="/assets/js/43.d1023d2d.js"><link rel="prefetch" href="/assets/js/44.8dad369c.js"><link rel="prefetch" href="/assets/js/45.ff361dd7.js"><link rel="prefetch" href="/assets/js/46.49304298.js"><link rel="prefetch" href="/assets/js/47.1c5831ae.js"><link rel="prefetch" href="/assets/js/49.5eba2b6e.js"><link rel="prefetch" href="/assets/js/5.ddf963dd.js"><link rel="prefetch" href="/assets/js/50.dfbe1c22.js"><link rel="prefetch" href="/assets/js/51.d9fdfbea.js"><link rel="prefetch" href="/assets/js/52.a121f851.js"><link rel="prefetch" href="/assets/js/53.3bb0c7fc.js"><link rel="prefetch" href="/assets/js/54.a7fa69c6.js"><link rel="prefetch" href="/assets/js/55.4c359ae5.js"><link rel="prefetch" href="/assets/js/56.33a0799e.js"><link rel="prefetch" href="/assets/js/57.c465e90e.js"><link rel="prefetch" href="/assets/js/58.691d8d8a.js"><link rel="prefetch" href="/assets/js/59.594c27c9.js"><link rel="prefetch" href="/assets/js/6.12b233b5.js"><link rel="prefetch" href="/assets/js/60.5201a3d1.js"><link rel="prefetch" href="/assets/js/61.32681885.js"><link rel="prefetch" href="/assets/js/62.6e55d1e0.js"><link rel="prefetch" href="/assets/js/63.dc31a81f.js"><link rel="prefetch" href="/assets/js/64.d0505ad5.js"><link rel="prefetch" href="/assets/js/65.d552dd35.js"><link rel="prefetch" href="/assets/js/66.35ea8347.js"><link rel="prefetch" href="/assets/js/67.313a26a0.js"><link rel="prefetch" href="/assets/js/68.fb234e41.js"><link rel="prefetch" href="/assets/js/69.949947b2.js"><link rel="prefetch" href="/assets/js/7.2b16b5c4.js"><link rel="prefetch" href="/assets/js/70.bcfab036.js"><link rel="prefetch" href="/assets/js/71.b640c269.js"><link rel="prefetch" href="/assets/js/72.52959c50.js"><link rel="prefetch" href="/assets/js/73.88fec446.js"><link rel="prefetch" href="/assets/js/74.c7fb870f.js"><link rel="prefetch" href="/assets/js/75.17d7dae1.js"><link rel="prefetch" href="/assets/js/76.a1121e5f.js"><link rel="prefetch" href="/assets/js/77.3135e1c9.js"><link rel="prefetch" href="/assets/js/78.728b493b.js"><link rel="prefetch" href="/assets/js/79.61d9b8d5.js"><link rel="prefetch" href="/assets/js/8.15bf96a4.js"><link rel="prefetch" href="/assets/js/80.ac274ef8.js"><link rel="prefetch" href="/assets/js/81.6b657ce8.js"><link rel="prefetch" href="/assets/js/82.ef3d371c.js"><link rel="prefetch" href="/assets/js/83.8af1a653.js"><link rel="prefetch" href="/assets/js/84.daec8638.js"><link rel="prefetch" href="/assets/js/85.3a86b662.js"><link rel="prefetch" href="/assets/js/86.c1fe0c89.js"><link rel="prefetch" href="/assets/js/87.3ec49eb9.js"><link rel="prefetch" href="/assets/js/88.c052dc11.js"><link rel="prefetch" href="/assets/js/89.134d933b.js"><link rel="prefetch" href="/assets/js/9.56e59f29.js"><link rel="prefetch" href="/assets/js/90.943f44d9.js"><link rel="prefetch" href="/assets/js/91.b465faaf.js"><link rel="prefetch" href="/assets/js/92.fe647c8f.js"><link rel="prefetch" href="/assets/js/93.2fb69ee4.js"><link rel="prefetch" href="/assets/js/94.7774734e.js"><link rel="prefetch" href="/assets/js/95.846c90a4.js"><link rel="prefetch" href="/assets/js/96.1736c419.js"><link rel="prefetch" href="/assets/js/97.cb9518b3.js"><link rel="prefetch" href="/assets/js/98.1949d6ce.js"><link rel="prefetch" href="/assets/js/99.d097c350.js">
    <link rel="stylesheet" href="/assets/css/0.styles.907785b2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Tech Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/angular.webp"></span> <span>Angular</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/angular/overview.html" class="sidebar-link">Overview</a></li><li><a href="/programming/angular/components.html" class="sidebar-link">Components</a></li><li><a href="/programming/angular/directives.html" class="sidebar-link">Directives</a></li><li><a href="/programming/angular/services.html" class="sidebar-link">Services and DI</a></li><li><a href="/programming/angular/routing.html" class="sidebar-link">Routing</a></li><li><a href="/programming/angular/observables.html" class="sidebar-link">Observables</a></li><li><a href="/programming/angular/forms.html" class="sidebar-link">Forms</a></li><li><a href="/programming/angular/pipes.html" class="sidebar-link">Pipes</a></li><li><a href="/programming/angular/http.html" aria-current="page" class="active sidebar-link">HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/angular/http.html#raw-response" class="sidebar-link">Raw Response</a></li><li class="sidebar-sub-header"><a href="/programming/angular/http.html#interceptors" class="sidebar-link">Interceptors</a></li><li class="sidebar-sub-header"><a href="/programming/angular/http.html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/programming/angular/http.html#best-practices" class="sidebar-link">Best Practices</a></li></ul></li><li><a href="/programming/angular/tips.html" class="sidebar-link">Tips</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/architecture.webp"></span> <span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="http-requests-in-angular"><a href="#http-requests-in-angular" class="header-anchor">#</a> HTTP Requests in Angular</h1> <p>Angular comes with a built-in HTTP client. That's a difference compared to
Vue.js or React, which do not provide such tooling.</p> <p>In order to use the built-in client, it needs to be imported into your module.
You need to import the <code>HttpClientModule</code>. With that in place, we can inject the
HTTP client into our classes, kind of similar to how we'd do in
<a href="/programming/dotnet/http-client.html">.NET</a>.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> httpClient<span class="token operator">:</span> HttpClient<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>HttpClient</code> has methods corresponding to actual HTTP methods, e.g.:</p> <div class="language-ts extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-ts"><code>httpClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">'api.com'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// read response...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

httpClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">'api.com'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Marcin'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">subsribe</span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// read response...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>By default, all these methods return an <code>Observable</code>. We can use
<a href="/programming/angular/observables.html#operators">operators</a> on them. <a href="/programming/angular/observables.html#error-handling">Error
handling</a> is also the same as in <code>Observables</code>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>The requests will actually NOT be sent out if nothing subscribes to
the returned <code>Observable</code>!</p> <p>We do not have to <code>unsubscribe()</code> from the observable, it's managed
by Angular.</p></div> <div class="custom-block tip"><p class="custom-block-title">Body</p> <p>Angular will serialize objects that should be sent as a body of the request
behind the scenes.</p></div> <p>Each method accepts an options object, which is the last parameter. There, we
can set things such as headers, query parameters, etc.</p> <h2 id="raw-response"><a href="#raw-response" class="header-anchor">#</a> Raw Response</h2> <p>By default, the subscrition returned when inoking an HTTP request, resolves to
an object representing the body of the response. In some cases, we might need
more data, like response headers or the status code. It can be configured via
the options object. Here's an example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> sub <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;api.com&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    observe<span class="token operator">:</span> <span class="token string">'response'</span> <span class="token comment">// 'body' by default</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Events</p> <p>We can also observe <code>'events'</code> This one will bring multiple messages to
subscribers, informing about the stages that the request is at (e.g. <code>Sent</code>,
<code>Response</code>, etc.).</p> <p>This seems to be the only useful use of <code>Observables</code> for HTTP requests, and a
very niche one. Otherwise, I don't really see why <code>Promises</code> wouldn't be
utilized by default.</p></div> <h3 id="response-string"><a href="#response-string" class="header-anchor">#</a> Response String</h3> <p>Angular automatically converts the responses to JS objects. We can tell it not
to do it:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> sub <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;api.com&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    responseType<span class="token operator">:</span> <span class="token string">'text'</span> <span class="token comment">// 'json' by default</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>It can't be used iwth generic versions of HTTP client's methods, it wouldn't
make sense anyway, because the whole point of these generics is to automatically
get a typed response.</p> <h2 id="interceptors"><a href="#interceptors" class="header-anchor">#</a> Interceptors</h2> <p>Interceptors allow us to set up some global action on outgoing HTTP requests
and/or incoming HTTP responses. They work a bit like middleware in ASP.NET Core.
Interceptors are created as services implementing <code>HttpInterceptor</code>.</p> <h3 id="request-interceptors"><a href="#request-interceptors" class="header-anchor">#</a> Request Interceptors</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptorService</span> <span class="token keyword">implements</span> <span class="token class-name">HttpInterceptor</span> <span class="token punctuation">{</span>
    <span class="token function">interpcet</span><span class="token punctuation">(</span>request<span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> next<span class="token operator">:</span> HttpHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// do something with the request (log, attach some headers, etc.)</span>
        <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// send the request further down the pipeline</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>request</code> argument is generic. If we know the type of the respones, we can
use it here instead of <code>any</code>.</p> <p>Here's how we register interceptors. In the module, we'd do:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    declaractions<span class="token operator">:</span> <span class="token punctuation">[</span> AppComponent <span class="token punctuation">]</span><span class="token punctuation">,</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span> BrowserModule<span class="token punctuation">,</span> HttpClientModule <span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> 
            provide<span class="token operator">:</span> <span class="token constant">HTTP_INTERCEPTORS</span><span class="token punctuation">,</span>
            useClass<span class="token operator">:</span> MyInterceptorService<span class="token punctuation">,</span>
            multi<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// with this, we can have multiple interceptors</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>What we're doing above is just the <a href="/programming/angular/services.html">DI</a>. We treat
<code>HTTP_INTERCEPTORS</code> as a placeholder for actual interceptors. Angular's inner
code asks for <code>HTTP_INTERCEPTORS</code> and it is given whatever we register.</p> <div class="custom-block tip"><p class="custom-block-title">Multiple Interceptors</p> <p>Here's how we'd register multiple interceptors:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>providers<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
        provide<span class="token operator">:</span> <span class="token constant">HTTP_INTERCEPTORS</span><span class="token punctuation">,</span>
        useClass<span class="token operator">:</span> MyInterceptorService<span class="token punctuation">,</span>
        multi<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> 
        provide<span class="token operator">:</span> <span class="token constant">HTTP_INTERCEPTORS</span><span class="token punctuation">,</span>
        useClass<span class="token operator">:</span> AnotherInterceptorService<span class="token punctuation">,</span>
        multi<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>The order of execution of the interceptors pipeline is the same as the order of
their registration.</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>In order to restrict the interceptor only to some sub-group of requests, we need
to filter requests out in the interceptor itself. All the interceptors are
invoked for any HTTP request.</p></div> <h3 id="response-interceptors"><a href="#response-interceptors" class="header-anchor">#</a> Response Interceptors</h3> <p>Intercepting incoming responses uses the same kind of services as shown
previously. This time though, we need to makse use of the fact that the second
parameter of the interceptor returns an <code>Observable</code>. It is going to notify us
of the lifetime of the request.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyInterceptorService</span> <span class="token keyword">implements</span> <span class="token class-name">HttpInterceptor</span> <span class="token punctuation">{</span>
    <span class="token function">interpcet</span><span class="token punctuation">(</span>request<span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> next<span class="token operator">:</span> HttpHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">tap</span><span class="token punctuation">(</span>event <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// do something...</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>event</code> that we get access to is the same kind of event that was mentioned
in <a href="#raw-response">Raw Response</a> section. We might want to filter out all the
events that are not of type equal to <code>Response</code>. The interceptor may modify the
response or do anything else with it.</p> <div class="custom-block tip"><p class="custom-block-title">RxJS tap</p> <p><code>tap</code> is an operator that allows us to do some action on every event, but it
does not transform the event in any way (like <code>map</code> would do for example).</p></div> <h2 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h2> <p>Instead of using <code>Observables</code>, we can utilize <code>Promises</code>, making it possile to
use <code>async</code>/<code>await</code> in our code:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> promise <span class="token operator">=</span> httpClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>Stuff<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">'api.com'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> promise<span class="token punctuation">;</span>
</code></pre></div><h2 id="best-practices"><a href="#best-practices" class="header-anchor">#</a> Best Practices</h2> <h3 id="services"><a href="#services" class="header-anchor">#</a> Services</h3> <p>Instead of using <code>HttpClient</code> in our components directly, it makes more sense to
put that logic into some service. Such a service would work like a kind of
repository for a specific kind of data being fetched.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/angular/pipes.html" class="prev">
        Pipes
      </a></span> <span class="next"><a href="/programming/angular/tips.html">
        Tips
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/4/2022, 6:29:57 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c20b4647.js" defer></script><script src="/assets/js/2.e154a615.js" defer></script><script src="/assets/js/48.fb50793f.js" defer></script>
  </body>
</html>
