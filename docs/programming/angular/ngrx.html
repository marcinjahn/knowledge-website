<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NgRx | Marcin Jahn | Tech Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="Application state management in Angular with NgRx">
    <meta property="og:url" content="/programming/angular/ngrx.html">
    <meta property="og:site_name" content="Marcin Jahn | Tech Notebook">
    <meta property="og:title" content="NgRx">
    <meta property="og:description" content="Application state management in Angular with NgRx">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Tech Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="#7D84B2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.907785b2.css" as="style"><link rel="preload" href="/assets/js/app.c0e280fd.js" as="script"><link rel="preload" href="/assets/js/2.e154a615.js" as="script"><link rel="preload" href="/assets/js/50.c9f420ff.js" as="script"><link rel="prefetch" href="/assets/js/10.4fa76c57.js"><link rel="prefetch" href="/assets/js/100.ac584d4e.js"><link rel="prefetch" href="/assets/js/101.6cae409e.js"><link rel="prefetch" href="/assets/js/102.61986edd.js"><link rel="prefetch" href="/assets/js/103.ceddef25.js"><link rel="prefetch" href="/assets/js/104.d91fc170.js"><link rel="prefetch" href="/assets/js/105.62b570cc.js"><link rel="prefetch" href="/assets/js/106.3889bfc7.js"><link rel="prefetch" href="/assets/js/107.7292c153.js"><link rel="prefetch" href="/assets/js/108.44f3837d.js"><link rel="prefetch" href="/assets/js/109.768aa32d.js"><link rel="prefetch" href="/assets/js/11.c22c2dd5.js"><link rel="prefetch" href="/assets/js/110.6fc9035b.js"><link rel="prefetch" href="/assets/js/111.6c546f56.js"><link rel="prefetch" href="/assets/js/112.bb53efef.js"><link rel="prefetch" href="/assets/js/113.1de1aba5.js"><link rel="prefetch" href="/assets/js/114.f1895934.js"><link rel="prefetch" href="/assets/js/115.ac23631a.js"><link rel="prefetch" href="/assets/js/116.4d7b53ab.js"><link rel="prefetch" href="/assets/js/117.ce81a8d2.js"><link rel="prefetch" href="/assets/js/118.b96bef2d.js"><link rel="prefetch" href="/assets/js/119.8aff28a2.js"><link rel="prefetch" href="/assets/js/12.80be005c.js"><link rel="prefetch" href="/assets/js/120.ad876841.js"><link rel="prefetch" href="/assets/js/121.38a349c3.js"><link rel="prefetch" href="/assets/js/122.3cfe414b.js"><link rel="prefetch" href="/assets/js/123.604ac053.js"><link rel="prefetch" href="/assets/js/124.7a367e13.js"><link rel="prefetch" href="/assets/js/125.1d66b980.js"><link rel="prefetch" href="/assets/js/126.9783f3dd.js"><link rel="prefetch" href="/assets/js/127.c7c47b88.js"><link rel="prefetch" href="/assets/js/128.ad02ff55.js"><link rel="prefetch" href="/assets/js/129.662aea38.js"><link rel="prefetch" href="/assets/js/13.7a44d7be.js"><link rel="prefetch" href="/assets/js/130.18f7c95b.js"><link rel="prefetch" href="/assets/js/131.99e2065f.js"><link rel="prefetch" href="/assets/js/132.2afed716.js"><link rel="prefetch" href="/assets/js/133.af785964.js"><link rel="prefetch" href="/assets/js/134.036228c7.js"><link rel="prefetch" href="/assets/js/135.54b56660.js"><link rel="prefetch" href="/assets/js/136.616ad9e7.js"><link rel="prefetch" href="/assets/js/137.7096493d.js"><link rel="prefetch" href="/assets/js/138.fb7b02c0.js"><link rel="prefetch" href="/assets/js/139.585adb50.js"><link rel="prefetch" href="/assets/js/14.ab8e1dcc.js"><link rel="prefetch" href="/assets/js/140.45aab80e.js"><link rel="prefetch" href="/assets/js/141.871daeef.js"><link rel="prefetch" href="/assets/js/142.e21b99da.js"><link rel="prefetch" href="/assets/js/143.2509d0d9.js"><link rel="prefetch" href="/assets/js/144.d6be8bcd.js"><link rel="prefetch" href="/assets/js/145.b62db9bc.js"><link rel="prefetch" href="/assets/js/146.d6c9db31.js"><link rel="prefetch" href="/assets/js/147.7604bdf0.js"><link rel="prefetch" href="/assets/js/148.cef9ae52.js"><link rel="prefetch" href="/assets/js/149.3f747f5c.js"><link rel="prefetch" href="/assets/js/15.89e1dd21.js"><link rel="prefetch" href="/assets/js/150.36596885.js"><link rel="prefetch" href="/assets/js/151.32cd3891.js"><link rel="prefetch" href="/assets/js/152.94984552.js"><link rel="prefetch" href="/assets/js/153.d6c6173e.js"><link rel="prefetch" href="/assets/js/154.746067b1.js"><link rel="prefetch" href="/assets/js/155.d238c556.js"><link rel="prefetch" href="/assets/js/156.c769970b.js"><link rel="prefetch" href="/assets/js/157.ee6511f0.js"><link rel="prefetch" href="/assets/js/158.f7cbc413.js"><link rel="prefetch" href="/assets/js/159.b34ae2c8.js"><link rel="prefetch" href="/assets/js/16.2a55624c.js"><link rel="prefetch" href="/assets/js/160.d0714dbd.js"><link rel="prefetch" href="/assets/js/161.153fa986.js"><link rel="prefetch" href="/assets/js/162.ae313346.js"><link rel="prefetch" href="/assets/js/163.6d17baf2.js"><link rel="prefetch" href="/assets/js/164.ef3d8d94.js"><link rel="prefetch" href="/assets/js/165.8baa923d.js"><link rel="prefetch" href="/assets/js/17.17b698d6.js"><link rel="prefetch" href="/assets/js/18.262c9795.js"><link rel="prefetch" href="/assets/js/19.cf1af818.js"><link rel="prefetch" href="/assets/js/20.956ebc37.js"><link rel="prefetch" href="/assets/js/21.68b3a94e.js"><link rel="prefetch" href="/assets/js/22.c89acf3d.js"><link rel="prefetch" href="/assets/js/23.7830c31b.js"><link rel="prefetch" href="/assets/js/24.22f6a490.js"><link rel="prefetch" href="/assets/js/25.acdbbc39.js"><link rel="prefetch" href="/assets/js/26.885530c7.js"><link rel="prefetch" href="/assets/js/27.8b94e32c.js"><link rel="prefetch" href="/assets/js/28.74a11e43.js"><link rel="prefetch" href="/assets/js/29.3bae65c8.js"><link rel="prefetch" href="/assets/js/3.54e9968c.js"><link rel="prefetch" href="/assets/js/30.cb2db743.js"><link rel="prefetch" href="/assets/js/31.a523528b.js"><link rel="prefetch" href="/assets/js/32.3b90ff2a.js"><link rel="prefetch" href="/assets/js/33.e414a879.js"><link rel="prefetch" href="/assets/js/34.1bec9902.js"><link rel="prefetch" href="/assets/js/35.a682d85c.js"><link rel="prefetch" href="/assets/js/36.2c3f8f9d.js"><link rel="prefetch" href="/assets/js/37.c37d1fcd.js"><link rel="prefetch" href="/assets/js/38.18cb3d3d.js"><link rel="prefetch" href="/assets/js/39.48e1c6c4.js"><link rel="prefetch" href="/assets/js/4.128ef882.js"><link rel="prefetch" href="/assets/js/40.85b85b8c.js"><link rel="prefetch" href="/assets/js/41.94d3e608.js"><link rel="prefetch" href="/assets/js/42.4216a2f8.js"><link rel="prefetch" href="/assets/js/43.d1023d2d.js"><link rel="prefetch" href="/assets/js/44.8dad369c.js"><link rel="prefetch" href="/assets/js/45.ff361dd7.js"><link rel="prefetch" href="/assets/js/46.49304298.js"><link rel="prefetch" href="/assets/js/47.1c5831ae.js"><link rel="prefetch" href="/assets/js/48.fb50793f.js"><link rel="prefetch" href="/assets/js/49.0ef86bca.js"><link rel="prefetch" href="/assets/js/5.84ed60bf.js"><link rel="prefetch" href="/assets/js/51.5b12a7c7.js"><link rel="prefetch" href="/assets/js/52.0450ff83.js"><link rel="prefetch" href="/assets/js/53.813a6074.js"><link rel="prefetch" href="/assets/js/54.a1c4ada0.js"><link rel="prefetch" href="/assets/js/55.6b0e7341.js"><link rel="prefetch" href="/assets/js/56.3c99382c.js"><link rel="prefetch" href="/assets/js/57.053c730a.js"><link rel="prefetch" href="/assets/js/58.c797622b.js"><link rel="prefetch" href="/assets/js/59.8072a137.js"><link rel="prefetch" href="/assets/js/6.5229f742.js"><link rel="prefetch" href="/assets/js/60.204d9351.js"><link rel="prefetch" href="/assets/js/61.8a4697b9.js"><link rel="prefetch" href="/assets/js/62.0c70df37.js"><link rel="prefetch" href="/assets/js/63.9fc89ae8.js"><link rel="prefetch" href="/assets/js/64.3c9e7981.js"><link rel="prefetch" href="/assets/js/65.833ea0cd.js"><link rel="prefetch" href="/assets/js/66.d16a90ea.js"><link rel="prefetch" href="/assets/js/67.61c9c0fe.js"><link rel="prefetch" href="/assets/js/68.be8fb435.js"><link rel="prefetch" href="/assets/js/69.20af85b4.js"><link rel="prefetch" href="/assets/js/7.46595839.js"><link rel="prefetch" href="/assets/js/70.7f3b845b.js"><link rel="prefetch" href="/assets/js/71.3242fecb.js"><link rel="prefetch" href="/assets/js/72.4e26de85.js"><link rel="prefetch" href="/assets/js/73.acc8589f.js"><link rel="prefetch" href="/assets/js/74.2e3b1a7b.js"><link rel="prefetch" href="/assets/js/75.0464fe89.js"><link rel="prefetch" href="/assets/js/76.a0e4dd78.js"><link rel="prefetch" href="/assets/js/77.6de0b2a7.js"><link rel="prefetch" href="/assets/js/78.a11de57b.js"><link rel="prefetch" href="/assets/js/79.dc5e1222.js"><link rel="prefetch" href="/assets/js/8.141a7866.js"><link rel="prefetch" href="/assets/js/80.dcdc8db2.js"><link rel="prefetch" href="/assets/js/81.4f75582f.js"><link rel="prefetch" href="/assets/js/82.698ebee6.js"><link rel="prefetch" href="/assets/js/83.2cbac3aa.js"><link rel="prefetch" href="/assets/js/84.9bdc05f4.js"><link rel="prefetch" href="/assets/js/85.1dc5f3ba.js"><link rel="prefetch" href="/assets/js/86.0365a114.js"><link rel="prefetch" href="/assets/js/87.cbc380f5.js"><link rel="prefetch" href="/assets/js/88.9ea99cb0.js"><link rel="prefetch" href="/assets/js/89.9f1da8dd.js"><link rel="prefetch" href="/assets/js/9.1b53687b.js"><link rel="prefetch" href="/assets/js/90.42328d36.js"><link rel="prefetch" href="/assets/js/91.f6c61ce0.js"><link rel="prefetch" href="/assets/js/92.b4ad9759.js"><link rel="prefetch" href="/assets/js/93.57529e13.js"><link rel="prefetch" href="/assets/js/94.99a4d21c.js"><link rel="prefetch" href="/assets/js/95.d28237ff.js"><link rel="prefetch" href="/assets/js/96.9af6339a.js"><link rel="prefetch" href="/assets/js/97.4f0642bd.js"><link rel="prefetch" href="/assets/js/98.e98c0391.js"><link rel="prefetch" href="/assets/js/99.72f7c537.js">
    <link rel="stylesheet" href="/assets/css/0.styles.907785b2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Tech Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/angular.webp"></span> <span>Angular</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/angular/overview.html" class="sidebar-link">Overview</a></li><li><a href="/programming/angular/components.html" class="sidebar-link">Components</a></li><li><a href="/programming/angular/directives.html" class="sidebar-link">Directives</a></li><li><a href="/programming/angular/services.html" class="sidebar-link">Services and DI</a></li><li><a href="/programming/angular/routing.html" class="sidebar-link">Routing</a></li><li><a href="/programming/angular/observables.html" class="sidebar-link">Observables</a></li><li><a href="/programming/angular/forms.html" class="sidebar-link">Forms</a></li><li><a href="/programming/angular/pipes.html" class="sidebar-link">Pipes</a></li><li><a href="/programming/angular/http.html" class="sidebar-link">HTTP</a></li><li><a href="/programming/angular/modules.html" class="sidebar-link">Modules</a></li><li><a href="/programming/angular/ngrx.html" aria-current="page" class="active sidebar-link">NgRx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/angular/ngrx.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/programming/angular/ngrx.html#some-building-blocks" class="sidebar-link">(Some) Building Blocks</a></li><li class="sidebar-sub-header"><a href="/programming/angular/ngrx.html#using-the-store" class="sidebar-link">Using the Store</a></li><li class="sidebar-sub-header"><a href="/programming/angular/ngrx.html#side-effects" class="sidebar-link">Side Effects</a></li></ul></li><li><a href="/programming/angular/tips.html" class="sidebar-link">Tips</a></li><li><a href="/programming/angular/standalone-components.html" class="sidebar-link">Standalone Components</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/architecture.webp"></span> <span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="ngrx"><a href="#ngrx" class="header-anchor">#</a> NgRx</h1> <p>NgRx is a framework for managing application state. Without it, our apps would
typically:</p> <ul><li>manage app state via services;</li> <li>services would be accessed from various components;</li> <li>there would be no control over state mutations.</li></ul> <p>NgRx is an Angular version of Redux - React's state management framework. It
makes use of RxJS making the state observable.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>NgRx is an overkill for smaller applications.</p></div> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i @ngrx/store <span class="token comment"># Core</span>
<span class="token function">npm</span> i @ngrx/effects <span class="token comment"># Side-effects</span>
</code></pre></div><h2 id="some-building-blocks"><a href="#some-building-blocks" class="header-anchor">#</a> (Some) Building Blocks</h2> <p>NgRx exposes three main types of entities:</p> <ul><li>store</li> <li>reducers</li> <li>actions</li></ul> <p>There is one store, but there are many actions and reducers:</p> <ul><li>each entity type will have its own reducer (e.g. Products or Users will have
their own reducers)</li> <li>each entity type will have 1 or more actions (e.g. Product will have
AddProduct, UpdateProduct, while Users will have AddUser, RemoveUser, etc.)</li> <li>each feature section of our app will have its own <code>store</code> directory where the
reducer and actions files will be kept</li></ul> <h3 id="actions"><a href="#actions" class="header-anchor">#</a> Actions</h3> <p>Actions are the atomic operations that we want to apply on our state. Things
such as adding, modifying, deleting data from our state is exposed via actions.
Each action is a separate class, with its own data. Additionally, each action
has its own <code>type</code>. That type is used to inform a reducer about the kind of
action that we want to execute.</p> <p>Since actions are typically small, it's OK to keep them all in one file. Here's
an example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// action types - there's a convention of prefixing string with the name of feature</span>
<span class="token comment">// in square brackets to avoid potential conflicts with other features</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ADD_PRODUCT</span> <span class="token operator">=</span> <span class="token string">'[Products Catalog] Add Product'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ADD_PRODUCTS</span> <span class="token operator">=</span> <span class="token string">'[Products Catalog] Add Products'</span><span class="token punctuation">;</span>

<span class="token comment">// actions</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AddProduct</span> <span class="token keyword">implements</span> <span class="token class-name">Action</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> type <span class="token operator">=</span> <span class="token constant">ADD_INGREDIENT</span><span class="token punctuation">;</span> <span class="token comment">// comes with the Action interface</span>

  <span class="token comment">// optional data</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> payload<span class="token operator">:</span> Product<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AddProducts</span> <span class="token keyword">implements</span> <span class="token class-name">Action</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> type <span class="token operator">=</span> <span class="token constant">ADD_INGREDIENTS</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> payload<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// such a union type makes the reducer's code more succinct</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ProductsActions</span> <span class="token operator">=</span> AddIngredient <span class="token operator">|</span> AddIngredients<span class="token punctuation">;</span>
</code></pre></div><p>Actions are <strong>dispatched</strong>, as we will see a bit later. Actions are a bit
similar to DTO objects. Some actor wants to do something with the store, so it
creates a new <code>Action</code> instance and dispatches it to the store (to be handled by
a reducer).</p> <h3 id="reducers"><a href="#reducers" class="header-anchor">#</a> Reducers</h3> <p>Reducers handle actions. A single reducer will handle all the actions of a
specific entity kind (like a Product). The store in our app is built with the
help of reducers!</p> <p>Reducer is a function that is invoked anytime some action is dispatched (and at
the bootstrap of our app!). It receives two parameters:</p> <ul><li>the current state (or an initial state if we set it up this way)</li> <li>the action (with its optional payload)</li></ul> <p>And, it returns the new state.</p> <p>Typically, a reducer will use a <code>switch-case</code> statement. Here's an example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// a typical import grouping all actions under one object</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ProductsCatalogActions <span class="token keyword">from</span> <span class="token string">&quot;./products.actions&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// a type of ProductsCatalog state.</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  selectedProduct<span class="token operator">?</span><span class="token operator">:</span> Product
<span class="token punctuation">}</span>

<span class="token comment">// optional initial state</span>
<span class="token keyword">const</span> initialState<span class="token operator">:</span> State <span class="token operator">=</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Book'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Ingredient</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Steam Deck'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  selectedProduct<span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>

<span class="token comment">// the actual reducer is a function</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">productsCatalogReducer</span><span class="token punctuation">(</span>
  state<span class="token operator">:</span> State <span class="token operator">=</span> initialState<span class="token punctuation">,</span> <span class="token comment">// reducer will be called by Angular on init with null state, so initialStae will jump in</span>
  action<span class="token operator">:</span> ProductsCatalogActions<span class="token punctuation">.</span>ProductsActions <span class="token comment">// our action union type</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// handles each action</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> ProductsActions<span class="token punctuation">.</span><span class="token constant">ADD_PRODUCT</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token comment">// a typicl pattern of copying the rest of the previous state</span>
        products<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>products<span class="token punctuation">,</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">]</span> <span class="token comment">// products field of the state gets replaced</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">case</span> ProductsActions<span class="token punctuation">.</span><span class="token constant">ADD_PRODUCTS</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        products<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>products<span class="token punctuation">,</span> <span class="token operator">...</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token comment">// the initial call (invoked by Angular) will not have any action.type, we return the initialState here</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Invocation</p> <p>Reducers are not invoked by our app components directly. Instead, it is handled by
NgRx when we <a href="#dispatch">dispatch some action</a> or on init (with action type set
to <em>@ngrx/store/init</em>).</p></div> <div class="custom-block warning"><p class="custom-block-title">State Modifications</p> <p>Reducer should always return new object(s). Modifications of existing state are
forbidden!</p></div> <div class="custom-block tip"><p class="custom-block-title">Union Type</p> <p>TypeScript's union type that groups all the actions makes the type recognition
great with <code>switch-case</code> or <code>if-else</code>. The compiler automatically infers the
type of <code>action.payload</code> based on the <code>case</code> that we're currently in.
We don't need to manually cast anything.</p></div> <h3 id="store-type"><a href="#store-type" class="header-anchor">#</a> Store Type</h3> <p>We probably are going to have a few kinds of data and a few reducers. It makes
sense to define a global type that defines all kinds of data being stored:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// naming convention for imports</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromproductsCatalog <span class="token keyword">from</span> <span class="token string">&quot;../products/store/products-catalog.reducer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromAuth <span class="token keyword">from</span> <span class="token string">&quot;../auth/store/auth.reducer&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AppState</span> <span class="token punctuation">{</span>
  productsCatalog<span class="token operator">:</span> fromProductsCatalog<span class="token punctuation">.</span>State<span class="token punctuation">,</span> <span class="token comment">// stores stuff related to products catalog</span>
  auth<span class="token operator">:</span> fromAuth<span class="token punctuation">.</span>State <span class="token comment">// stores auth data (like currently logged-in user)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>With such a type, it's easier to inject the store into classes. Since the
<code>AppState</code> type is global within our app, it makes sense to put it in its own
file called <code>app.reducer.ts</code>, in the <code>/app/store/</code> directory.</p> <p>In the same file, we can also put the listing of all the reducers within our app:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">const</span> appReducer<span class="token operator">:</span> ActionReducerMap<span class="token operator">&lt;</span>AppState<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  shoppingList<span class="token operator">:</span> fromShoppingList<span class="token punctuation">.</span>shoppingListReducer<span class="token punctuation">,</span>
  auth<span class="token operator">:</span> fromAuth<span class="token punctuation">.</span>authReducer
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>It will come useful very quickly.</p> <h2 id="using-the-store"><a href="#using-the-store" class="header-anchor">#</a> Using the Store</h2> <h3 id="register"><a href="#register" class="header-anchor">#</a> Register</h3> <p>First of all, our store needs to be imported in some module:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromApp <span class="token keyword">from</span> <span class="token string">&quot;./store/app.reducer&quot;</span><span class="token punctuation">;</span> <span class="token comment">// again, import convention</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span>
    AppComponent
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    BrowserModule<span class="token punctuation">,</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span>fromApp<span class="token punctuation">.</span>appReducer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// appReducer is our reducers map</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  bootstrap<span class="token operator">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><p>This is the place where we inform the framework of any reducers that we have
defined. In the end, the reducers build up the store in the app.</p> <h3 id="inject"><a href="#inject" class="header-anchor">#</a> Inject</h3> <p>Our components or services may inject the <code>Store</code> in order to access
its data:</p> <div class="language-ts extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fromApp <span class="token keyword">from</span> <span class="token string">&quot;../store/app.reducer&quot;</span><span class="token punctuation">;</span>

<span class="token function">constructor</span><span class="token punctuation">(</span>
  <span class="token keyword">private</span> store<span class="token operator">:</span> Store<span class="token operator">&lt;</span>fromApp<span class="token punctuation">.</span>AppState<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><p>The <code>Store&lt;&gt;</code> is a generic type. Thanks to <a href="#store-type">Store Type</a> being
defined as an interface, we can quickly specify our store.</p> <h3 id="use"><a href="#use" class="header-anchor">#</a> Use</h3> <h4 id="dispatch"><a href="#dispatch" class="header-anchor">#</a> Dispatch</h4> <p>We can dispatch actions like this:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProductsCatalogActions</span><span class="token punctuation">.</span><span class="token function">AddProduct</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That dispatch will go through NgRx's internals, which will invoke our reducer.
Based on the action (<code>AddProduct</code>) it will update the store with the new
<code>product</code>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Whenever we dispatch some action, it's not just the corresponding reducer that
gets invoked. All the reducers get invoked! Only one of them will have proper
handler for the supplied action type, other reducers will just execute their
&quot;default&quot; case.</p></div> <h4 id="subscribe"><a href="#subscribe" class="header-anchor">#</a> Subscribe</h4> <p>Store's data is exposed via <code>Observable</code>s:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>products$<span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token punctuation">{</span> products<span class="token operator">:</span> products<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>products$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'productsCatalog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Any <code>dispatch</code> that &quot;modifies&quot; the store, would bring data via the subscription.</p> <div class="custom-block warning"><p class="custom-block-title">Unsibscribe</p> <p>Like with any subscription, we need to rememebr to <code>unsubscribe</code> on destroy.</p></div> <h2 id="side-effects"><a href="#side-effects" class="header-anchor">#</a> Side Effects</h2> <p>(<a href="https://www.npmjs.com/package/@ngrx/effects" target="_blank" rel="noopener noreferrer">@ngrx/effects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) is an additional
package for NgRx that adds <strong>Side Effects</strong>. Until now we had some actions
defined, and reducers that acted on them. Reducers focused on state
&quot;modifications&quot;. They should not contain any logic other than that.</p> <p>However, our state actions are often associated with some additional logic that
we need to execute - sending some network request, storing some data in local
storage, etc. Such additional (but required) operations may be put into effects.</p> <p>Each feature in our app can have its own <code>store/*.effects.ts</code> file. Here's an
example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>
</code></pre></div><p>Effects typically return observable returning NgRx actions. That's because
effects are kind of in-between stuff that happens when we invoke some action.
Example of that could be an effect that:</p> <ol><li>Listens for the <em>[Auth] Login Start</em> actions</li> <li>Wehever such action comes in, it sends a login request to some authentication server</li> <li>When the response comes back, it either issues <em>[Auth] Logic Success</em> or <em>[Auth] Login Fail</em> action.</li> <li>The reducer sets up the state properly for all 3 kinds of actions mentioned above.</li> <li>Some UI component subscribes to state changes and reacts properly to each
state change.</li></ol> <p>In some cases though, effects do not emit any actions. Instead, some effect
could use a <a href="/programming/angular/routing.html">Router</a> to redirect the user somewhere else.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/angular/modules.html" class="prev">
        Modules
      </a></span> <span class="next"><a href="/programming/angular/tips.html">
        Tips
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/20/2022, 6:26:05 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c0e280fd.js" defer></script><script src="/assets/js/2.e154a615.js" defer></script><script src="/assets/js/50.c9f420ff.js" defer></script>
  </body>
</html>
