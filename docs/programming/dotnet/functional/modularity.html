<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Modularity | Marcin Jahn | Technology Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="Dependency Injection in Functional Programs">
    <meta property="og:url" content="/programming/dotnet/functional/modularity.html">
    <meta property="og:site_name" content="Marcin Jahn | Technology Notebook">
    <meta property="og:title" content="Modularity">
    <meta property="og:description" content="Dependency Injection in Functional Programs">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Technology Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="white">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.8f8d1251.css" as="style"><link rel="preload" href="/assets/js/app.7b03465d.js" as="script"><link rel="preload" href="/assets/js/2.36a2c6d0.js" as="script"><link rel="preload" href="/assets/js/61.174efb01.js" as="script"><link rel="prefetch" href="/assets/js/10.271ec805.js"><link rel="prefetch" href="/assets/js/100.11545a76.js"><link rel="prefetch" href="/assets/js/101.a3e35fa5.js"><link rel="prefetch" href="/assets/js/102.3043b705.js"><link rel="prefetch" href="/assets/js/103.4cd17f51.js"><link rel="prefetch" href="/assets/js/104.efb156b9.js"><link rel="prefetch" href="/assets/js/105.cd8ec472.js"><link rel="prefetch" href="/assets/js/106.0429ba77.js"><link rel="prefetch" href="/assets/js/107.0feef589.js"><link rel="prefetch" href="/assets/js/108.63ca75d0.js"><link rel="prefetch" href="/assets/js/109.c704fe50.js"><link rel="prefetch" href="/assets/js/11.c8949bba.js"><link rel="prefetch" href="/assets/js/110.8d787563.js"><link rel="prefetch" href="/assets/js/111.02592af9.js"><link rel="prefetch" href="/assets/js/112.c75f45a1.js"><link rel="prefetch" href="/assets/js/113.b8926304.js"><link rel="prefetch" href="/assets/js/114.c2da58ad.js"><link rel="prefetch" href="/assets/js/115.85ce4d7e.js"><link rel="prefetch" href="/assets/js/116.fc80e726.js"><link rel="prefetch" href="/assets/js/117.bff48cff.js"><link rel="prefetch" href="/assets/js/118.ea0ebb41.js"><link rel="prefetch" href="/assets/js/119.81458c75.js"><link rel="prefetch" href="/assets/js/12.45ae2e1a.js"><link rel="prefetch" href="/assets/js/120.db62f06f.js"><link rel="prefetch" href="/assets/js/121.bf61cd70.js"><link rel="prefetch" href="/assets/js/122.4d67800c.js"><link rel="prefetch" href="/assets/js/123.32c8d274.js"><link rel="prefetch" href="/assets/js/124.f5a22512.js"><link rel="prefetch" href="/assets/js/125.f813ca0b.js"><link rel="prefetch" href="/assets/js/126.0dd68138.js"><link rel="prefetch" href="/assets/js/127.efdf023e.js"><link rel="prefetch" href="/assets/js/128.e175039f.js"><link rel="prefetch" href="/assets/js/129.4c038db5.js"><link rel="prefetch" href="/assets/js/13.e190eea0.js"><link rel="prefetch" href="/assets/js/130.bd0159b9.js"><link rel="prefetch" href="/assets/js/131.cf8944ea.js"><link rel="prefetch" href="/assets/js/132.9a088074.js"><link rel="prefetch" href="/assets/js/133.364e8a04.js"><link rel="prefetch" href="/assets/js/134.94dbeb82.js"><link rel="prefetch" href="/assets/js/135.497bdd31.js"><link rel="prefetch" href="/assets/js/136.811224f5.js"><link rel="prefetch" href="/assets/js/137.e85a314c.js"><link rel="prefetch" href="/assets/js/138.10da8ebf.js"><link rel="prefetch" href="/assets/js/139.f27a12d3.js"><link rel="prefetch" href="/assets/js/14.097b720c.js"><link rel="prefetch" href="/assets/js/15.098d835a.js"><link rel="prefetch" href="/assets/js/16.d602d9cd.js"><link rel="prefetch" href="/assets/js/17.0eea71d6.js"><link rel="prefetch" href="/assets/js/18.8ee72991.js"><link rel="prefetch" href="/assets/js/19.071a3642.js"><link rel="prefetch" href="/assets/js/20.a6abb0e6.js"><link rel="prefetch" href="/assets/js/21.62d9c10b.js"><link rel="prefetch" href="/assets/js/22.4a097822.js"><link rel="prefetch" href="/assets/js/23.044add3a.js"><link rel="prefetch" href="/assets/js/24.286bebc9.js"><link rel="prefetch" href="/assets/js/25.f5ca6f1e.js"><link rel="prefetch" href="/assets/js/26.50f751f3.js"><link rel="prefetch" href="/assets/js/27.62e987ed.js"><link rel="prefetch" href="/assets/js/28.ee1355b0.js"><link rel="prefetch" href="/assets/js/29.7fa2b670.js"><link rel="prefetch" href="/assets/js/3.26d57cde.js"><link rel="prefetch" href="/assets/js/30.91a8e4c5.js"><link rel="prefetch" href="/assets/js/31.4d55d4ba.js"><link rel="prefetch" href="/assets/js/32.764694ea.js"><link rel="prefetch" href="/assets/js/33.af7d0528.js"><link rel="prefetch" href="/assets/js/34.7ca80cf3.js"><link rel="prefetch" href="/assets/js/35.6b53fb08.js"><link rel="prefetch" href="/assets/js/36.d33384df.js"><link rel="prefetch" href="/assets/js/37.787d1c8b.js"><link rel="prefetch" href="/assets/js/38.616448ed.js"><link rel="prefetch" href="/assets/js/39.9d066180.js"><link rel="prefetch" href="/assets/js/4.dfa29469.js"><link rel="prefetch" href="/assets/js/40.14ca74e5.js"><link rel="prefetch" href="/assets/js/41.ac5684e8.js"><link rel="prefetch" href="/assets/js/42.ca412ed2.js"><link rel="prefetch" href="/assets/js/43.8db5cdd5.js"><link rel="prefetch" href="/assets/js/44.67018cbd.js"><link rel="prefetch" href="/assets/js/45.1694db28.js"><link rel="prefetch" href="/assets/js/46.ca8f4d43.js"><link rel="prefetch" href="/assets/js/47.8d08aed3.js"><link rel="prefetch" href="/assets/js/48.bf89838f.js"><link rel="prefetch" href="/assets/js/49.6af3aa82.js"><link rel="prefetch" href="/assets/js/5.42fecfd8.js"><link rel="prefetch" href="/assets/js/50.e04a52be.js"><link rel="prefetch" href="/assets/js/51.f21e43c9.js"><link rel="prefetch" href="/assets/js/52.245e651f.js"><link rel="prefetch" href="/assets/js/53.e3537480.js"><link rel="prefetch" href="/assets/js/54.eca631d3.js"><link rel="prefetch" href="/assets/js/55.43a84e35.js"><link rel="prefetch" href="/assets/js/56.cf5a9d8b.js"><link rel="prefetch" href="/assets/js/57.e5ec317c.js"><link rel="prefetch" href="/assets/js/58.e12822c8.js"><link rel="prefetch" href="/assets/js/59.ffb27c91.js"><link rel="prefetch" href="/assets/js/6.606a3e1d.js"><link rel="prefetch" href="/assets/js/60.8b29fd47.js"><link rel="prefetch" href="/assets/js/62.d4ec2744.js"><link rel="prefetch" href="/assets/js/63.607654a6.js"><link rel="prefetch" href="/assets/js/64.13c7091e.js"><link rel="prefetch" href="/assets/js/65.1f08d192.js"><link rel="prefetch" href="/assets/js/66.3863080e.js"><link rel="prefetch" href="/assets/js/67.83c4aa14.js"><link rel="prefetch" href="/assets/js/68.2c1f392e.js"><link rel="prefetch" href="/assets/js/69.7f48b160.js"><link rel="prefetch" href="/assets/js/7.bbb2dfe1.js"><link rel="prefetch" href="/assets/js/70.1f898769.js"><link rel="prefetch" href="/assets/js/71.f0b72368.js"><link rel="prefetch" href="/assets/js/72.6f3464df.js"><link rel="prefetch" href="/assets/js/73.6ce8b2f1.js"><link rel="prefetch" href="/assets/js/74.1c75ba80.js"><link rel="prefetch" href="/assets/js/75.8274a770.js"><link rel="prefetch" href="/assets/js/76.e030185d.js"><link rel="prefetch" href="/assets/js/77.6fc4c27c.js"><link rel="prefetch" href="/assets/js/78.f64999a5.js"><link rel="prefetch" href="/assets/js/79.8fe89075.js"><link rel="prefetch" href="/assets/js/8.86407f37.js"><link rel="prefetch" href="/assets/js/80.7dbf4be8.js"><link rel="prefetch" href="/assets/js/81.07b6158e.js"><link rel="prefetch" href="/assets/js/82.1bc222bf.js"><link rel="prefetch" href="/assets/js/83.6200cc4e.js"><link rel="prefetch" href="/assets/js/84.430c0054.js"><link rel="prefetch" href="/assets/js/85.3d6215c4.js"><link rel="prefetch" href="/assets/js/86.34770a2a.js"><link rel="prefetch" href="/assets/js/87.71d3bfa3.js"><link rel="prefetch" href="/assets/js/88.4eadf1a1.js"><link rel="prefetch" href="/assets/js/89.b31a47ab.js"><link rel="prefetch" href="/assets/js/9.adfb7c91.js"><link rel="prefetch" href="/assets/js/90.6601dd7a.js"><link rel="prefetch" href="/assets/js/91.ce16fe30.js"><link rel="prefetch" href="/assets/js/92.81b69a02.js"><link rel="prefetch" href="/assets/js/93.e65d18b6.js"><link rel="prefetch" href="/assets/js/94.52785345.js"><link rel="prefetch" href="/assets/js/95.a5f82b29.js"><link rel="prefetch" href="/assets/js/96.d5ab8da2.js"><link rel="prefetch" href="/assets/js/97.823e7667.js"><link rel="prefetch" href="/assets/js/98.ea63d3fc.js"><link rel="prefetch" href="/assets/js/99.a4f7c31e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f8d1251.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Technology Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/dotnet/http-client.html" class="sidebar-link">HTTPClient</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>Async</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/programming/dotnet/equality.html" class="sidebar-link">Equality</a></li><li><a href="/programming/dotnet/comparisons.html" class="sidebar-link">Comparisons</a></li><li><a href="/programming/dotnet/generic-host.html" class="sidebar-link">Generic Host</a></li><li><a href="/programming/dotnet/logging.html" class="sidebar-link">Logging</a></li><li><a href="/programming/dotnet/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/programming/dotnet/records.html" class="sidebar-link">Records</a></li><li><a href="/programming/dotnet/grpc.html" class="sidebar-link">gRPC</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>ASP.NET Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>Entity Framework Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><!----> <span>Functional Programming</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/dotnet/functional/fundamentals.html" class="sidebar-link">Fundamentals of Functional Programming</a></li><li><a href="/programming/dotnet/functional/dotnet-features.html" class="sidebar-link">.NET Functional Features</a></li><li><a href="/programming/dotnet/functional/signatures.html" class="sidebar-link">Signatures</a></li><li><a href="/programming/dotnet/functional/composition.html" class="sidebar-link">Function Composition</a></li><li><a href="/programming/dotnet/functional/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/programming/dotnet/functional/partial-application.html" class="sidebar-link">Partial Application</a></li><li><a href="/programming/dotnet/functional/modularity.html" aria-current="page" class="active sidebar-link">Modularity</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/dotnet/functional/modularity.html#dependency-injection" class="sidebar-link">Dependency Injection</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/functional/modularity.html#modularity-in-fp" class="sidebar-link">Modularity in FP</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="modularity"><a href="#modularity" class="header-anchor">#</a> Modularity</h1> <h2 id="dependency-injection"><a href="#dependency-injection" class="header-anchor">#</a> Dependency Injection</h2> <p>In a typical C# program, we'd have something like this:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ITimeProvider</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name">DateTime</span> <span class="token function">GetTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultTimeProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ITimeProvider</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">DateTime</span> <span class="token function">GetTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateValidator</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ITimeProvider</span> _timeProvider<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">DateValidator</span><span class="token punctuation">(</span><span class="token class-name">ITimeProvider</span> timeProvider<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _timeProvider <span class="token operator">=</span> timeProvider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Validate</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        order<span class="token punctuation">.</span>Time <span class="token operator">&lt;=</span> _timeProvider<span class="token punctuation">.</span><span class="token function">GetTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// DI</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ITimeProvider<span class="token punctuation">,</span> DefaultTimeProvider<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DateValidator<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We need to contact the &quot;outside world&quot; to get the time. In order to make the
code testable, the time-getting functionality was extracted to an external
class. There's also an interface that makes it easy to create a mock and inject
it. We end up with lots of interfaces with just one implementation - that's
not the purpose of interfaces. It brings much boiler-plate code.</p> <p>We could use function-injection to achieve the same behavior:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token return-type class-name">DateTime</span> <span class="token function">Clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DateValidator</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">Clock</span> _clock<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">DateValidator</span><span class="token punctuation">(</span><span class="token class-name">Clock</span> clock<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _clock <span class="token operator">=</span> clock<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Validate</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        order<span class="token punctuation">.</span>Time <span class="token operator">&lt;=</span> <span class="token function">_clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// DI</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Clock<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">)</span><span class="token punctuation">;</span>
services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DateValidator<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Records</p> <p>We could make the code even shorter with a record.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">record</span> <span class="token class-name">DateValidator</span><span class="token punctuation">(</span><span class="token class-name">Clock</span> Clock<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Validate</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        order<span class="token punctuation">.</span>Time <span class="token operator">&lt;=</span> <span class="token function">Clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="custom-block tip"><p class="custom-block-title">Delegate</p> <p>Usage of a new delegate type was not necessary. We could just use
<code>Func&lt;DateTime&gt;</code>. A <code>Clock</code> type makes it a bit more readable.</p></div> <p>The presented example is still a bit semi-functional. Ideally, we should
transform the <code>DateValidator</code> class into a function.</p> <h2 id="modularity-in-fp"><a href="#modularity-in-fp" class="header-anchor">#</a> Modularity in FP</h2> <p>In OOP, we use interfaces and their implementations that are injected whenever
an interface is required.</p> <p>In FP, we don't use interfaces. The function's signature is the interface
itself. Additionally, instead of creating classes that contain some logic, FP
promotes the idea of creating functions with that logic. Then, if some other
component requires that logic, a delegate should be used to inform about that
(instead of an interface).</p> <p>Here's a practical example:</p> <p>OOP:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MakeTransferController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
<span class="token punctuation">{</span>
    <span class="token class-name">IValidator<span class="token punctuation">&lt;</span>MakeRequest<span class="token punctuation">&gt;</span></span> _validator<span class="token punctuation">;</span>
    <span class="token class-name">TransferHandler</span> _handler<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpPost</span><span class="token punctuation">,</span> <span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;api/transfers/book&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IActionResult</span> <span class="token function">MakeTransfer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span> <span class="token class-name">MakeTransfer</span> cmd<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        _validator<span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Map</span><span class="token punctuation">(</span>_handler<span class="token punctuation">.</span>Save<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span>
            Invalid <span class="token operator">=&gt;</span> BadRequest<span class="token punctuation">,</span>
            Valid <span class="token operator">=&gt;</span> <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// + some typical IoC dependencies registration</span>
</code></pre></div><p>FP:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token return-type class-name">Validation<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token function">Validator</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns handler</span>
<span class="token keyword">static</span> <span class="token return-type class-name">Func<span class="token punctuation">&lt;</span>MakeRequest<span class="token punctuation">,</span> IResult<span class="token punctuation">&gt;</span></span> <span class="token function">HandleSaveTransfer</span><span class="token punctuation">(</span>
    <span class="token class-name">Validator<span class="token punctuation">&lt;</span>MakeTransfer<span class="token punctuation">&gt;</span></span> validate<span class="token punctuation">,</span>
    <span class="token class-name">Func<span class="token punctuation">&lt;</span>MakeRequest<span class="token punctuation">,</span> Exceptional<span class="token punctuation">&lt;</span>Unit<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> save<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        transfer <span class="token operator">=&gt;</span>
        <span class="token function">validate</span><span class="token punctuation">(</span>transfer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Map</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span>
            Invalid <span class="token operator">=&gt;</span> BadRequest<span class="token punctuation">,</span>
            Valid <span class="token operator">=&gt;</span> <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

<span class="token comment">// Invoked during bootstrap</span>
<span class="token keyword">static</span> <span class="token return-type class-name">Func<span class="token punctuation">&lt;</span>MakeRequest<span class="token punctuation">,</span> IResult<span class="token punctuation">&gt;</span></span> <span class="token function">ConfgureSaveTransferHandler</span><span class="token punctuation">(</span><span class="token class-name">IConfiguration</span> config<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> connString <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">GetSection</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">var</span></span> save <span class="token operator">=</span> connString<span class="token punctuation">.</span><span class="token function">CreateInserter</span><span class="token punctuation">(</span><span class="token string">&quot;INSERT ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// some factory function</span>
    <span class="token class-name"><span class="token keyword">var</span></span> validate <span class="token operator">=</span> <span class="token function">DateNotPast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// some factory function</span>
    <span class="token keyword">return</span> <span class="token function">HandleSaveTransfer</span><span class="token punctuation">(</span>validate<span class="token punctuation">,</span> save<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">var</span></span> <span class="token function">handleSaveTransfer</span><span class="token punctuation">(</span><span class="token function">ConfgureSaveTransferHandler</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">MapPost</span><span class="token punctuation">(</span><span class="token string">&quot;/api/transfers/book&quot;</span><span class="token punctuation">,</span> handleSaveTransfer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">RunAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Dependecies are not stored in any fields, they are passed as parameters to the
function.</p> <div class="custom-block tip"><p class="custom-block-title">Partial Application</p> <p>The code above is an example of <a href="/programming/dotnet/functional/partial-application.html">Partial Application</a>.
In order to save the transfer, three parameters are required:</p> <ul><li>validator</li> <li>saver</li> <li>request details</li></ul> <p>We Have a HOF that accepts the first two parameters to create a function which
only needs the last remaining parameter.</p></div> <div class="custom-block warning"><p class="custom-block-title">.NET 6</p> <p>The last code block uses .NET 6's Minimal APIs feature that enables functional
approach. Older SDKs may use the <a href="https://github.com/featherhttp/framework" target="_blank" rel="noopener noreferrer">Feather HTTP
framework<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <p>The functional approach still has decoupled components (functions). Testing
should become a bit easier, creating mock functions is easier than creating mock
objects.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/dotnet/functional/partial-application.html" class="prev">
        Partial Application
      </a></span> <span class="next"><a href="/programming/javascript/oop.html">
        OOP
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/2/2022, 2:58:06 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7b03465d.js" defer></script><script src="/assets/js/2.36a2c6d0.js" defer></script><script src="/assets/js/61.174efb01.js" defer></script>
  </body>
</html>
