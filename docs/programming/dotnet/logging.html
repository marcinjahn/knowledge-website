<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Logging | Marcin Jahn | Technology Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="Using Serilog in .NET">
    <meta property="og:url" content="/programming/dotnet/logging.html">
    <meta property="og:site_name" content="Marcin Jahn | Technology Notebook">
    <meta property="og:title" content="Logging">
    <meta property="og:description" content="Using Serilog in .NET">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Technology Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="white">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.f7c29e46.css" as="style"><link rel="preload" href="/assets/js/app.1a75dedc.js" as="script"><link rel="preload" href="/assets/js/2.ebe3edc5.js" as="script"><link rel="preload" href="/assets/js/64.9ff2a2b8.js" as="script"><link rel="prefetch" href="/assets/js/10.9a87b115.js"><link rel="prefetch" href="/assets/js/100.a004066b.js"><link rel="prefetch" href="/assets/js/101.98d7eae4.js"><link rel="prefetch" href="/assets/js/102.d367dc9c.js"><link rel="prefetch" href="/assets/js/103.48646cdd.js"><link rel="prefetch" href="/assets/js/104.b5ac1a10.js"><link rel="prefetch" href="/assets/js/105.5449f057.js"><link rel="prefetch" href="/assets/js/106.afe0985e.js"><link rel="prefetch" href="/assets/js/107.7b588ec7.js"><link rel="prefetch" href="/assets/js/108.56996842.js"><link rel="prefetch" href="/assets/js/109.3fc97ef4.js"><link rel="prefetch" href="/assets/js/11.289c0888.js"><link rel="prefetch" href="/assets/js/110.4ff693bc.js"><link rel="prefetch" href="/assets/js/111.a7cd6d21.js"><link rel="prefetch" href="/assets/js/112.50094470.js"><link rel="prefetch" href="/assets/js/113.723f2756.js"><link rel="prefetch" href="/assets/js/114.a1debb6a.js"><link rel="prefetch" href="/assets/js/115.bb77c326.js"><link rel="prefetch" href="/assets/js/116.390c4c56.js"><link rel="prefetch" href="/assets/js/117.7c55998f.js"><link rel="prefetch" href="/assets/js/118.7173ed9d.js"><link rel="prefetch" href="/assets/js/119.5e5d0f5a.js"><link rel="prefetch" href="/assets/js/12.02062816.js"><link rel="prefetch" href="/assets/js/120.73fd5a69.js"><link rel="prefetch" href="/assets/js/121.312e7da5.js"><link rel="prefetch" href="/assets/js/122.4925846d.js"><link rel="prefetch" href="/assets/js/123.fa848433.js"><link rel="prefetch" href="/assets/js/124.6bfe76c2.js"><link rel="prefetch" href="/assets/js/125.44de8350.js"><link rel="prefetch" href="/assets/js/126.14d6ac82.js"><link rel="prefetch" href="/assets/js/127.5867b31f.js"><link rel="prefetch" href="/assets/js/128.65b80027.js"><link rel="prefetch" href="/assets/js/129.2aca6f5a.js"><link rel="prefetch" href="/assets/js/13.27855381.js"><link rel="prefetch" href="/assets/js/130.f70e3680.js"><link rel="prefetch" href="/assets/js/131.aae7f80a.js"><link rel="prefetch" href="/assets/js/14.47dc7f50.js"><link rel="prefetch" href="/assets/js/15.06e55b5f.js"><link rel="prefetch" href="/assets/js/16.851551ba.js"><link rel="prefetch" href="/assets/js/17.d49024cc.js"><link rel="prefetch" href="/assets/js/18.9a028418.js"><link rel="prefetch" href="/assets/js/19.1561b47a.js"><link rel="prefetch" href="/assets/js/20.cc990a73.js"><link rel="prefetch" href="/assets/js/21.9009db40.js"><link rel="prefetch" href="/assets/js/22.dedd33bd.js"><link rel="prefetch" href="/assets/js/23.07b672f1.js"><link rel="prefetch" href="/assets/js/24.7d474002.js"><link rel="prefetch" href="/assets/js/25.41d4fd6e.js"><link rel="prefetch" href="/assets/js/26.e7fac7da.js"><link rel="prefetch" href="/assets/js/27.6547052b.js"><link rel="prefetch" href="/assets/js/28.3d0140b9.js"><link rel="prefetch" href="/assets/js/29.0fc86592.js"><link rel="prefetch" href="/assets/js/3.77d5e480.js"><link rel="prefetch" href="/assets/js/30.9ab402b6.js"><link rel="prefetch" href="/assets/js/31.e66781af.js"><link rel="prefetch" href="/assets/js/32.e45aef6d.js"><link rel="prefetch" href="/assets/js/33.f53f22a0.js"><link rel="prefetch" href="/assets/js/34.1249180a.js"><link rel="prefetch" href="/assets/js/35.d13e15f7.js"><link rel="prefetch" href="/assets/js/36.0af61c54.js"><link rel="prefetch" href="/assets/js/37.0fbda6ba.js"><link rel="prefetch" href="/assets/js/38.4ad6cce9.js"><link rel="prefetch" href="/assets/js/39.9ba7ed65.js"><link rel="prefetch" href="/assets/js/4.6bd850ca.js"><link rel="prefetch" href="/assets/js/40.0ee2c23c.js"><link rel="prefetch" href="/assets/js/41.20eb987d.js"><link rel="prefetch" href="/assets/js/42.f169c791.js"><link rel="prefetch" href="/assets/js/43.8132a52b.js"><link rel="prefetch" href="/assets/js/44.856fd0bb.js"><link rel="prefetch" href="/assets/js/45.15f169bf.js"><link rel="prefetch" href="/assets/js/46.687b60ce.js"><link rel="prefetch" href="/assets/js/47.081774d3.js"><link rel="prefetch" href="/assets/js/48.d1b52774.js"><link rel="prefetch" href="/assets/js/49.6a74ef12.js"><link rel="prefetch" href="/assets/js/5.a753d39d.js"><link rel="prefetch" href="/assets/js/50.f6a3f3d1.js"><link rel="prefetch" href="/assets/js/51.bb86f3e5.js"><link rel="prefetch" href="/assets/js/52.8bbc3a7d.js"><link rel="prefetch" href="/assets/js/53.3a845119.js"><link rel="prefetch" href="/assets/js/54.5ad9bb9a.js"><link rel="prefetch" href="/assets/js/55.cd1cdae9.js"><link rel="prefetch" href="/assets/js/56.e54de15a.js"><link rel="prefetch" href="/assets/js/57.86f052bc.js"><link rel="prefetch" href="/assets/js/58.7a473a12.js"><link rel="prefetch" href="/assets/js/59.b5644728.js"><link rel="prefetch" href="/assets/js/6.e008b738.js"><link rel="prefetch" href="/assets/js/60.f4919ab7.js"><link rel="prefetch" href="/assets/js/61.c3a1966d.js"><link rel="prefetch" href="/assets/js/62.3730af2e.js"><link rel="prefetch" href="/assets/js/63.7180471c.js"><link rel="prefetch" href="/assets/js/65.b4959742.js"><link rel="prefetch" href="/assets/js/66.022a948d.js"><link rel="prefetch" href="/assets/js/67.c53ffcde.js"><link rel="prefetch" href="/assets/js/68.370f2a85.js"><link rel="prefetch" href="/assets/js/69.9ef7b74a.js"><link rel="prefetch" href="/assets/js/7.705d8a11.js"><link rel="prefetch" href="/assets/js/70.0e611821.js"><link rel="prefetch" href="/assets/js/71.c137fc8e.js"><link rel="prefetch" href="/assets/js/72.31fc1a87.js"><link rel="prefetch" href="/assets/js/73.3b62c1c7.js"><link rel="prefetch" href="/assets/js/74.52ddd888.js"><link rel="prefetch" href="/assets/js/75.5f2ec06a.js"><link rel="prefetch" href="/assets/js/76.d55ba59e.js"><link rel="prefetch" href="/assets/js/77.1d156bb8.js"><link rel="prefetch" href="/assets/js/78.3bc9f378.js"><link rel="prefetch" href="/assets/js/79.33623219.js"><link rel="prefetch" href="/assets/js/8.ad403723.js"><link rel="prefetch" href="/assets/js/80.b889712b.js"><link rel="prefetch" href="/assets/js/81.af4f2ca2.js"><link rel="prefetch" href="/assets/js/82.f7f69ab9.js"><link rel="prefetch" href="/assets/js/83.bee96ebf.js"><link rel="prefetch" href="/assets/js/84.670c4455.js"><link rel="prefetch" href="/assets/js/85.f0a77343.js"><link rel="prefetch" href="/assets/js/86.b79edaab.js"><link rel="prefetch" href="/assets/js/87.3daf94a0.js"><link rel="prefetch" href="/assets/js/88.99e05927.js"><link rel="prefetch" href="/assets/js/89.283f97fa.js"><link rel="prefetch" href="/assets/js/9.dda0363d.js"><link rel="prefetch" href="/assets/js/90.6f2f7cd7.js"><link rel="prefetch" href="/assets/js/91.bb692fd1.js"><link rel="prefetch" href="/assets/js/92.6e3aa945.js"><link rel="prefetch" href="/assets/js/93.4602eb2c.js"><link rel="prefetch" href="/assets/js/94.6f90dd2a.js"><link rel="prefetch" href="/assets/js/95.b99b5d66.js"><link rel="prefetch" href="/assets/js/96.02fcde20.js"><link rel="prefetch" href="/assets/js/97.dc3b4edd.js"><link rel="prefetch" href="/assets/js/98.3585a636.js"><link rel="prefetch" href="/assets/js/99.57422738.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7c29e46.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Technology Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>.NET</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/dotnet/http-client.html" class="sidebar-link">HTTPClient</a></li><li><a href="/programming/dotnet/async.html" class="sidebar-link">Async</a></li><li><a href="/programming/dotnet/equality.html" class="sidebar-link">Equality</a></li><li><a href="/programming/dotnet/comparisons.html" class="sidebar-link">Comparisons</a></li><li><a href="/programming/dotnet/generic-host.html" class="sidebar-link">Generic Host</a></li><li><a href="/programming/dotnet/logging.html" aria-current="page" class="active sidebar-link">Logging</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/dotnet/logging.html#structured-logging" class="sidebar-link">Structured Logging</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/logging.html#serilog" class="sidebar-link">Serilog</a></li></ul></li><li><a href="/programming/dotnet/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/programming/dotnet/records.html" class="sidebar-link">Records</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ASP.NET Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Entity Framework Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Functional Programming</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="logging-in-net"><a href="#logging-in-net" class="header-anchor">#</a> Logging in .NET</h1> <h2 id="structured-logging"><a href="#structured-logging" class="header-anchor">#</a> Structured Logging</h2> <p>When logging and using a provider that supports structured/semantic logging, we
should provide parameters the following way:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// GOOD</span>
_logger<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span><span class="token string">&quot;User {userId} logged in&quot;</span><span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// BAD</span>
_logger<span class="token punctuation">.</span><span class="token function">logInformation</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;User </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">userId</span><span class="token punctuation">}</span></span><span class="token string"> logged in&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The first way stores both the value of the parameter (the actual user
identifier) and the name of this parameter. In the second approach, the name is
lost, so we are not able to filter based on the named parameter (<code>userId</code>).</p> <div class="custom-block tip"><p class="custom-block-title">JSON</p> <p>The structured logging information is stored as JSON. For example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;eventLevel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Information&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Device.IoTHubService&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eventId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1543&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;messageTemplate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Device {deviceId} has connected to IoT Hub&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Device 123 has connected to IoT Hub&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="log-storage"><a href="#log-storage" class="header-anchor">#</a> Log Storage</h3> <p>Structured logs can be stored in systems like:</p> <ul><li>Elasticsearch</li> <li>Seq</li></ul> <h2 id="serilog"><a href="#serilog" class="header-anchor">#</a> Serilog</h2> <p>Using Serilog:</p> <ol><li><p>Install NuGet packages:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet <span class="token function">add</span> package Serilog.Sinks.Console <span class="token comment"># Console sink</span>
dotnet <span class="token function">add</span> package Serilog.Settings.Configuration <span class="token comment"># allows reading settings from a file</span>
dotnet <span class="token function">add</span> package Serilog.Extensions.Logging <span class="token comment"># DI</span>
</code></pre></div></li> <li><p>Use Serilog with DI</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> host <span class="token operator">=</span> Host<span class="token punctuation">.</span><span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> services<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    services<span class="token punctuation">.</span><span class="token function">AddLogging</span><span class="token punctuation">(</span>builder <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">LoggerConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>ReadFrom<span class="token punctuation">.</span><span class="token function">Configuration</span><span class="token punctuation">(</span>host<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span> <span class="token comment">// Serilog.Settings.Configuration</span>
            <span class="token punctuation">.</span><span class="token function">CreateLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        builder<span class="token punctuation">.</span><span class="token function">ClearProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// removes the default logger</span>
        builder<span class="token punctuation">.</span><span class="token function">AddSerilog</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Other services...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>Configure</p> <p>In <code>appsettings.json</code>:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Serilog&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Using&quot;</span><span class="token operator">:</span>  <span class="token punctuation">[</span> <span class="token string">&quot;Serilog.Sinks.Console&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;MinimumLevel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Debug&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;WriteTo&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Console&quot;</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>More information can be found
<a href="https://github.com/serilog/serilog-settings-configuration" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></li></ol> <div class="custom-block tip"><p class="custom-block-title">Rider</p> <p>Sometimes Rider may display logs in black font color on the dark background. To
change that, got to the &quot;Preferences -&gt; Editor -&gt; Color Scheme -&gt; Console
Colors&quot; and change &quot;Bright White&quot; color to <strong>#FFFFFF</strong>.</p></div> <h3 id="usage-without-dependency-injection"><a href="#usage-without-dependency-injection" class="header-anchor">#</a> Usage without Dependency Injection</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code>Log<span class="token punctuation">.</span>Logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">LoggerConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>WriteTo<span class="token punctuation">.</span><span class="token function">Console</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">CreateLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Run the app...</span>
<span class="token punctuation">}</span>
<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    Log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;Host terminated unexpectedly&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">finally</span>
<span class="token punctuation">{</span>
    Log<span class="token punctuation">.</span><span class="token function">CloseAndFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="logging-to-files-with-serilog"><a href="#logging-to-files-with-serilog" class="header-anchor">#</a> Logging to files with Serilog</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddLogging</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IServiceCollection</span> services<span class="token punctuation">,</span> <span class="token class-name">AppConfiguration</span> appConfiguration<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    services<span class="token punctuation">.</span><span class="token function">AddLogging</span><span class="token punctuation">(</span>services<span class="token punctuation">,</span> builder <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">SetMinimumLevel</span><span class="token punctuation">(</span>appConfiguration<span class="token punctuation">.</span>LogLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">AddSerilog</span><span class="token punctuation">(</span>builder<span class="token punctuation">,</span> <span class="token function">GetSerilogLogger</span><span class="token punctuation">(</span>appConfiguration<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name">Serilog<span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Logger</span> <span class="token function">GetSerilogLogger</span><span class="token punctuation">(</span><span class="token class-name">AppConfiguration</span> appConfiguration<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> configuration <span class="token operator">=</span> Serilog<span class="token punctuation">.</span>ConsoleLoggerConfigurationExtensions<span class="token punctuation">.</span><span class="token function">Console</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Serilog<span class="token punctuation">.</span>LoggerConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>MinimumLevel<span class="token punctuation">.</span><span class="token function">Verbose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>WriteTo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>appConfiguration<span class="token punctuation">.</span>LogToFile<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Serilog<span class="token punctuation">.</span>FileLoggerConfigurationExtensions<span class="token punctuation">.</span><span class="token function">File</span><span class="token punctuation">(</span>configuration<span class="token punctuation">.</span>WriteTo<span class="token punctuation">,</span> appConfiguration<span class="token punctuation">.</span>LogPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> configuration<span class="token punctuation">.</span><span class="token function">CreateLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/dotnet/generic-host.html" class="prev">
        Generic Host
      </a></span> <span class="next"><a href="/programming/dotnet/configuration.html">
        Configuration
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/19/2022, 7:33:24 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1a75dedc.js" defer></script><script src="/assets/js/2.ebe3edc5.js" defer></script><script src="/assets/js/64.9ff2a2b8.js" defer></script>
  </body>
</html>
