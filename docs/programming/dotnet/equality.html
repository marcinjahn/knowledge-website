<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Equality | Marcin Jahn | Tech Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="How equality works in .NET">
    <meta property="og:url" content="/programming/dotnet/equality.html">
    <meta property="og:site_name" content="Marcin Jahn | Tech Notebook">
    <meta property="og:title" content="Equality">
    <meta property="og:description" content="How equality works in .NET">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Tech Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="#7D84B2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.c2e909f7.css" as="style"><link rel="preload" href="/assets/js/app.8b586a49.js" as="script"><link rel="preload" href="/assets/js/2.e154a615.js" as="script"><link rel="preload" href="/assets/js/67.f179d173.js" as="script"><link rel="prefetch" href="/assets/js/10.c21393e7.js"><link rel="prefetch" href="/assets/js/100.a95003a2.js"><link rel="prefetch" href="/assets/js/101.7cb540d1.js"><link rel="prefetch" href="/assets/js/102.e39d78f7.js"><link rel="prefetch" href="/assets/js/103.e5336cc6.js"><link rel="prefetch" href="/assets/js/104.0e0a9b98.js"><link rel="prefetch" href="/assets/js/105.1bacaa99.js"><link rel="prefetch" href="/assets/js/106.03f5a24a.js"><link rel="prefetch" href="/assets/js/107.5e3f7b38.js"><link rel="prefetch" href="/assets/js/108.2dcc2af6.js"><link rel="prefetch" href="/assets/js/109.88a510f3.js"><link rel="prefetch" href="/assets/js/11.e1aab1a5.js"><link rel="prefetch" href="/assets/js/110.1f8ee028.js"><link rel="prefetch" href="/assets/js/111.692fefdc.js"><link rel="prefetch" href="/assets/js/112.4b8f58ff.js"><link rel="prefetch" href="/assets/js/113.68faaba8.js"><link rel="prefetch" href="/assets/js/114.930d9317.js"><link rel="prefetch" href="/assets/js/115.8a0a32e1.js"><link rel="prefetch" href="/assets/js/116.bbb747a1.js"><link rel="prefetch" href="/assets/js/117.825aa311.js"><link rel="prefetch" href="/assets/js/118.9fa37276.js"><link rel="prefetch" href="/assets/js/119.b722d540.js"><link rel="prefetch" href="/assets/js/12.361a6720.js"><link rel="prefetch" href="/assets/js/120.52b4d894.js"><link rel="prefetch" href="/assets/js/121.6241ae0d.js"><link rel="prefetch" href="/assets/js/122.f7426903.js"><link rel="prefetch" href="/assets/js/123.a6fa147e.js"><link rel="prefetch" href="/assets/js/124.eb8dd68a.js"><link rel="prefetch" href="/assets/js/125.cf3f8e82.js"><link rel="prefetch" href="/assets/js/126.4c7f0be7.js"><link rel="prefetch" href="/assets/js/127.0fdd7b11.js"><link rel="prefetch" href="/assets/js/128.6033e4fc.js"><link rel="prefetch" href="/assets/js/129.f93ebc48.js"><link rel="prefetch" href="/assets/js/13.ba69ee7d.js"><link rel="prefetch" href="/assets/js/130.36d47e14.js"><link rel="prefetch" href="/assets/js/131.b4aa0fc2.js"><link rel="prefetch" href="/assets/js/132.9c2a3303.js"><link rel="prefetch" href="/assets/js/133.26573095.js"><link rel="prefetch" href="/assets/js/134.c68d7fba.js"><link rel="prefetch" href="/assets/js/135.01dc6565.js"><link rel="prefetch" href="/assets/js/136.420ffe7e.js"><link rel="prefetch" href="/assets/js/137.08512217.js"><link rel="prefetch" href="/assets/js/138.2f11bd7d.js"><link rel="prefetch" href="/assets/js/139.94f1cb93.js"><link rel="prefetch" href="/assets/js/14.ab8e1dcc.js"><link rel="prefetch" href="/assets/js/140.f5dde52b.js"><link rel="prefetch" href="/assets/js/141.2a4a926b.js"><link rel="prefetch" href="/assets/js/142.ffe2c294.js"><link rel="prefetch" href="/assets/js/143.2bdfcdd3.js"><link rel="prefetch" href="/assets/js/144.a0d09d04.js"><link rel="prefetch" href="/assets/js/145.92a8f4b1.js"><link rel="prefetch" href="/assets/js/146.b820c8cf.js"><link rel="prefetch" href="/assets/js/147.2845530d.js"><link rel="prefetch" href="/assets/js/148.d67cf3bc.js"><link rel="prefetch" href="/assets/js/149.3686d09e.js"><link rel="prefetch" href="/assets/js/15.89e1dd21.js"><link rel="prefetch" href="/assets/js/150.dc43560a.js"><link rel="prefetch" href="/assets/js/151.5d43ad5a.js"><link rel="prefetch" href="/assets/js/16.2a55624c.js"><link rel="prefetch" href="/assets/js/17.c28b8357.js"><link rel="prefetch" href="/assets/js/18.d1b19e28.js"><link rel="prefetch" href="/assets/js/19.cf1af818.js"><link rel="prefetch" href="/assets/js/20.1c8e8717.js"><link rel="prefetch" href="/assets/js/21.10c03aef.js"><link rel="prefetch" href="/assets/js/22.a404cd1c.js"><link rel="prefetch" href="/assets/js/23.f4b4bfb2.js"><link rel="prefetch" href="/assets/js/24.136fce21.js"><link rel="prefetch" href="/assets/js/25.a892b8a7.js"><link rel="prefetch" href="/assets/js/26.78aabf8a.js"><link rel="prefetch" href="/assets/js/27.c5166945.js"><link rel="prefetch" href="/assets/js/28.1d01ec88.js"><link rel="prefetch" href="/assets/js/29.fcefebb1.js"><link rel="prefetch" href="/assets/js/3.54e9968c.js"><link rel="prefetch" href="/assets/js/30.e2779bd8.js"><link rel="prefetch" href="/assets/js/31.5b0c8780.js"><link rel="prefetch" href="/assets/js/32.3b90ff2a.js"><link rel="prefetch" href="/assets/js/33.e414a879.js"><link rel="prefetch" href="/assets/js/34.1bec9902.js"><link rel="prefetch" href="/assets/js/35.a682d85c.js"><link rel="prefetch" href="/assets/js/36.2c3f8f9d.js"><link rel="prefetch" href="/assets/js/37.c37d1fcd.js"><link rel="prefetch" href="/assets/js/38.18cb3d3d.js"><link rel="prefetch" href="/assets/js/39.48e1c6c4.js"><link rel="prefetch" href="/assets/js/4.f5e5d89d.js"><link rel="prefetch" href="/assets/js/40.85b85b8c.js"><link rel="prefetch" href="/assets/js/41.94d3e608.js"><link rel="prefetch" href="/assets/js/42.4216a2f8.js"><link rel="prefetch" href="/assets/js/43.d1023d2d.js"><link rel="prefetch" href="/assets/js/44.8dad369c.js"><link rel="prefetch" href="/assets/js/45.1f6047dd.js"><link rel="prefetch" href="/assets/js/46.62047ba2.js"><link rel="prefetch" href="/assets/js/47.475f40f9.js"><link rel="prefetch" href="/assets/js/48.12680be5.js"><link rel="prefetch" href="/assets/js/49.23d1ca70.js"><link rel="prefetch" href="/assets/js/5.e51d424f.js"><link rel="prefetch" href="/assets/js/50.3cccea92.js"><link rel="prefetch" href="/assets/js/51.60977eb9.js"><link rel="prefetch" href="/assets/js/52.6cd304b8.js"><link rel="prefetch" href="/assets/js/53.f02218d6.js"><link rel="prefetch" href="/assets/js/54.b2f388df.js"><link rel="prefetch" href="/assets/js/55.b12636eb.js"><link rel="prefetch" href="/assets/js/56.ce8934a6.js"><link rel="prefetch" href="/assets/js/57.71d8183b.js"><link rel="prefetch" href="/assets/js/58.18f8652b.js"><link rel="prefetch" href="/assets/js/59.8f4a26ad.js"><link rel="prefetch" href="/assets/js/6.b4096339.js"><link rel="prefetch" href="/assets/js/60.48c63c98.js"><link rel="prefetch" href="/assets/js/61.26d5b3f2.js"><link rel="prefetch" href="/assets/js/62.5445b2cc.js"><link rel="prefetch" href="/assets/js/63.c4edc6a0.js"><link rel="prefetch" href="/assets/js/64.b37e720b.js"><link rel="prefetch" href="/assets/js/65.01eed1a3.js"><link rel="prefetch" href="/assets/js/66.2ca45e53.js"><link rel="prefetch" href="/assets/js/68.a9ad0b0a.js"><link rel="prefetch" href="/assets/js/69.d22436e0.js"><link rel="prefetch" href="/assets/js/7.8127b5e3.js"><link rel="prefetch" href="/assets/js/70.9bb23c27.js"><link rel="prefetch" href="/assets/js/71.87f270d4.js"><link rel="prefetch" href="/assets/js/72.d0c39eda.js"><link rel="prefetch" href="/assets/js/73.8109cfbe.js"><link rel="prefetch" href="/assets/js/74.cd32f7e8.js"><link rel="prefetch" href="/assets/js/75.0302ebe9.js"><link rel="prefetch" href="/assets/js/76.de3fc193.js"><link rel="prefetch" href="/assets/js/77.0dc1f9dd.js"><link rel="prefetch" href="/assets/js/78.edf927ee.js"><link rel="prefetch" href="/assets/js/79.15c4587c.js"><link rel="prefetch" href="/assets/js/8.5f339f67.js"><link rel="prefetch" href="/assets/js/80.fa3edd98.js"><link rel="prefetch" href="/assets/js/81.36525ef9.js"><link rel="prefetch" href="/assets/js/82.637c7e82.js"><link rel="prefetch" href="/assets/js/83.98a8bcb7.js"><link rel="prefetch" href="/assets/js/84.57209ca1.js"><link rel="prefetch" href="/assets/js/85.316adb20.js"><link rel="prefetch" href="/assets/js/86.d2840a70.js"><link rel="prefetch" href="/assets/js/87.2c38ad24.js"><link rel="prefetch" href="/assets/js/88.79beb7a1.js"><link rel="prefetch" href="/assets/js/89.e982af4a.js"><link rel="prefetch" href="/assets/js/9.54051397.js"><link rel="prefetch" href="/assets/js/90.61d2c318.js"><link rel="prefetch" href="/assets/js/91.a21de31b.js"><link rel="prefetch" href="/assets/js/92.5bd4754e.js"><link rel="prefetch" href="/assets/js/93.a2392afa.js"><link rel="prefetch" href="/assets/js/94.709d3a64.js"><link rel="prefetch" href="/assets/js/95.81ef28e2.js"><link rel="prefetch" href="/assets/js/96.060eb55a.js"><link rel="prefetch" href="/assets/js/97.2642c51a.js"><link rel="prefetch" href="/assets/js/98.f17c65b7.js"><link rel="prefetch" href="/assets/js/99.b2ff8dae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c2e909f7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Tech Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-6d74c91a><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-06466073 data-v-6d74c91a><img src="/img/linkedin.webp" data-v-06466073></a><a target="_blank" href="https://github.com/marcinjahn" data-v-06466073 data-v-6d74c91a><img src="/img/github.webp" data-v-06466073></a><a target="_blank" href="https://www.cirro.services" data-v-06466073 data-v-6d74c91a><span data-v-06466073>cirro.services</span></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/dotnet/http-client.html" class="sidebar-link">HTTPClient</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>Async</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/programming/dotnet/equality.html" aria-current="page" class="active sidebar-link">Equality</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#good-practices" class="sidebar-link">Good Practices</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#hash-codes" class="sidebar-link">Hash Codes</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#object-s-virtual-equals-object-o-method" class="sidebar-link">Object's virtual Equals(object o) method</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#object-s-static-equals-object-o1-object-o2-method" class="sidebar-link">Object's static Equals(object o1, object o2) method</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#object-s-referenceequals-object-o-method" class="sidebar-link">Object's ReferenceEquals(Object o) method</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#iequatable-t" class="sidebar-link">IEquatable&lt;T&gt;</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#operator" class="sidebar-link">== operator</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#iequalitycomparer-t" class="sidebar-link">IEqualityComparer&lt;T&gt;</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#istructuralequatable" class="sidebar-link">IStructuralEquatable</a></li><li class="sidebar-sub-header"><a href="/programming/dotnet/equality.html#other-notes" class="sidebar-link">Other Notes</a></li></ul></li><li><a href="/programming/dotnet/comparisons.html" class="sidebar-link">Comparisons</a></li><li><a href="/programming/dotnet/generic-host.html" class="sidebar-link">Generic Host</a></li><li><a href="/programming/dotnet/logging.html" class="sidebar-link">Logging</a></li><li><a href="/programming/dotnet/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/programming/dotnet/records.html" class="sidebar-link">Records</a></li><li><a href="/programming/dotnet/grpc.html" class="sidebar-link">gRPC</a></li><li><a href="/programming/dotnet/platform-invoke.html" class="sidebar-link">Platform Invoke</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>ASP.NET Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>Entity Framework Core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><!----> <span>Functional Programming</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/architecture.webp"></span> <span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="equality"><a href="#equality" class="header-anchor">#</a> Equality</h1> <h2 id="good-practices"><a href="#good-practices" class="header-anchor">#</a> Good Practices</h2> <h3 id="reference-types"><a href="#reference-types" class="header-anchor">#</a> Reference Types</h3> <ul><li>Override <code>Object</code>'s virtual <code>Equals(object o)</code> method (check for: <code>null</code>,
<code>ReferenceEquals</code>, fields/properties). For inherited types, first call
<code>base.Equals()</code> and then check for added properties/fields</li> <li>Implement <code>==</code> and <code>!=</code> - to enable <code>==</code> and <code>!=</code> (could use the <code>Object</code>'s
static <code>Equals</code>, which will call the overridern <code>Equals</code>)</li> <li>All of the above should give the same results</li> <li>Implement <code>Object.GetHashCode()</code></li></ul> <p>Implementing <code>IEnumerable&lt;T&gt;</code> is not recommended since it introduces inheritance
problems (unless the class is <code>sealed</code>) and does not give any real benefits
here.</p> <h3 id="value-types"><a href="#value-types" class="header-anchor">#</a> Value Types</h3> <ul><li>Implement <code>IEquatable&lt;T&gt;</code> - to avoid boxing and have type safety</li> <li>Override <code>Object</code>'s virtual <code>Equals(object o)</code> method - to avoid reflection
(just call the <code>IEquatable&lt;T&gt;</code> version)</li> <li>Implement <code>==</code> and <code>!=</code> - to enable <code>==</code> and <code>!=</code> (just call the
<code>IEquatable&lt;T&gt;</code> version)</li> <li>All of the above should give the same results</li> <li>Implement <code>Object.GetHashCode()</code></li></ul> <h2 id="hash-codes"><a href="#hash-codes" class="header-anchor">#</a> Hash Codes</h2> <p>Hash codes are used in HashSets and Dictionaries to be able to retrieve elements
efficiently. If two objects are equal they should have the same hash codes (or
dictionaries might not work)! Therefore <code>Equals</code> and <code>GetHashCode</code> should rely
on the same set of properties to get the result.</p> <p>It's recommended to implement hashcodes using XOR operator (<code>^</code>):</p> <div class="language- extra-class"><pre class="language-text"><code>public override int GetHashCode()
{
    return prop1.GetHashCode() ^ prop2.GetHashCode()
}
</code></pre></div><h2 id="object-s-virtual-equals-object-o-method"><a href="#object-s-virtual-equals-object-o-method" class="header-anchor">#</a> <code>Object</code>'s virtual <code>Equals(object o)</code> method</h2> <h3 id="classes"><a href="#classes" class="header-anchor">#</a> Classes</h3> <p>In classes it evaluates <strong>reference</strong> equality, unless overriden. <code>String</code>,
<code>tuples</code> and <code>delegate</code> have it overriden.</p> <h3 id="structs"><a href="#structs" class="header-anchor">#</a> Structs</h3> <p>In structs it compares values - all fields are compared (uses reflection). It's
recommended to override <code>Equals(object o)</code> by ourselves, because reflection has
very bad performance.</p> <p>It involves boxing in case of value types, which also is not a good thing. It's
a good practice to always override <code>GetHashCode</code> when overriding <code>Equals</code>.</p> <h2 id="object-s-static-equals-object-o1-object-o2-method"><a href="#object-s-static-equals-object-o1-object-o2-method" class="header-anchor">#</a> <code>Object</code>'s static <code>Equals(object o1, object o2)</code> method</h2> <p>This method makes it safe to compare 2 objects if one of them is <code>NULL</code>. If they
are not both <code>NULL</code>, the virtual <code>Equals</code> of <code>o1</code> is used (as described above).
So this method gives the same result as virtual one (only it protects from case
where <code>o1</code> is <code>NULL</code>).</p> <p>It cannot be overriden (because it's static)</p> <h2 id="object-s-referenceequals-object-o-method"><a href="#object-s-referenceequals-object-o-method" class="header-anchor">#</a> <code>Object</code>'s <code>ReferenceEquals(Object o)</code> method</h2> <p>It checks only reference, it cannot be overriden (becasue it's static). Useful
in the case where some type overrides the virtual <code>Equals</code>, but also wants to
check for reference equality.</p> <h2 id="iequatable-t"><a href="#iequatable-t" class="header-anchor">#</a> <code>IEquatable&lt;T&gt;</code></h2> <p>It has the following method: <code>Equals(T other)</code> - it is strongly typed, which is
good for value types (no boxing). All numeric primitive types implement it
(<code>Int</code>, <code>byte</code>, ...), other primitives not always. Some reference types
implement it (i.e. <code>String</code>).</p> <p>If some type implements it, we should make sure that both strong typed <code>Equals</code>
and the one from <code>Object</code> return the same results.</p> <p>It is not good for reference types:</p> <ul><li>there is no boxing, so no improvement in this area</li> <li>doesn't play nicely with inheritance</li></ul> <h2 id="operator"><a href="#operator" class="header-anchor">#</a> <code>==</code> operator</h2> <p>It's a feature of C#, not .NET. If overriding <code>Object</code>'s <code>Equals</code>, <code>==</code> also
should be overriden. <code>==</code> does not use <code>Equals</code> - it uses <code>eqc</code> IL procedure
directly, which (?) uses hardware (unless overriden).</p> <p><code>Tuple</code> does not override <code>==</code>, but overrides <code>Object.Equals()</code> - because of
that operator only checks reference equality and can return different result
than <code>Object.Equals()</code> - bad practice!</p> <p>Implementing <code>==</code> requires implementing also <code>!=</code> (by compiler).</p> <h3 id="inheritance"><a href="#inheritance" class="header-anchor">#</a> Inheritance</h3> <p><code>==</code> does not work well with inheritance - if we cast <code>MyClass</code> to <code>Object</code> and
compare, it will use <code>Object</code>'s <code>==</code> implementation (reference equality).
<code>Equals</code> methods don't have this issue.</p> <h3 id="generics"><a href="#generics" class="header-anchor">#</a> Generics</h3> <p>With generics, <code>==</code> ALWAYS compares references (even if <code>T</code> implements the
operator). <code>Object.Equals()</code> should be used here!</p> <h3 id="struct"><a href="#struct" class="header-anchor">#</a> Struct</h3> <p>For value types it has to be overloaded before using it.</p> <h3 id="classes-2"><a href="#classes-2" class="header-anchor">#</a> Classes</h3> <p>For classes it compares the references (memory addresses), unless overriden.</p> <h3 id="overloading"><a href="#overloading" class="header-anchor">#</a> Overloading</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span> left<span class="token punctuation">,</span> <span class="token class-name">MyClass</span> right<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token comment">// Equality logic</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">!=</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span> left<span class="token punctuation">,</span> <span class="token class-name">MyClass</span> right<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token comment">// Inequality logic</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The logic should be the same as in <code>Object.Equals()</code>!</p> <h2 id="iequalitycomparer-t"><a href="#iequalitycomparer-t" class="header-anchor">#</a> <code>IEqualityComparer&lt;T&gt;</code></h2> <p>Requires <code>Equals</code> and <code>GetHashCode</code> to be implemented. It's adviced to inherit
from <code>EqualityComparer&lt;T&gt;</code> base class (similar as with <code>Comparer&lt;T&gt;</code>).</p> <p>EqualityComparer is adviced to be a singleton.</p> <p>It's problematic to deal with derived types - as exmplained in my notes on
comparers.</p> <p><code>EqualityComparer&lt;T&gt;.Default</code> - every type can use the default comparer, which
uses the <code>T</code>'s equality implementation.</p> <p><code>StringComparer</code> is a static class that has 6 variosu comparers for strings
(implements <code>IComparer</code> and <code>IEqualityComparer</code>).</p> <h2 id="istructuralequatable"><a href="#istructuralequatable" class="header-anchor">#</a> <code>IStructuralEquatable</code></h2> <p>Collections are structurally equal if:</p> <ul><li>they contain same elements</li> <li>elements are in the same order</li></ul> <p>Arrays and tuples implement it explicitly - in order to use it, we need to cast
an array to <code>IStructuralEquatable</code> and use <code>Equals</code> It's not generic.</p> <h2 id="other-notes"><a href="#other-notes" class="header-anchor">#</a> Other Notes</h2> <p>In .NET <code>NULL</code> always equals <code>NULL</code>, i.e.: <code>Object.Equals(null, null)</code> returns
<code>TRUE</code>.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/dotnet/async/tips.html" class="prev">
        TAP Tips
      </a></span> <span class="next"><a href="/programming/dotnet/comparisons.html">
        Comparisons
      </a>
      →
    </span></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/27/2022, 11:43:56 AM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.8b586a49.js" defer></script><script src="/assets/js/2.e154a615.js" defer></script><script src="/assets/js/67.f179d173.js" defer></script>
  </body>
</html>
