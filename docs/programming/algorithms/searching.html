<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Searching | Marcin Jahn | Technology Notebook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-ZSM2N36X8P"></script>
    <script>(function() { if (window.location.href.startsWith('http://localhost')) { return; } window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZSM2N36X8P'); })();</script>
    <meta name="description" content="Searching through collections (arrays, strings)">
    <meta property="og:url" content="/programming/algorithms/searching.html">
    <meta property="og:site_name" content="Marcin Jahn | Technology Notebook">
    <meta property="og:title" content="Searching">
    <meta property="og:description" content="Searching through collections (arrays, strings)">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Marcin Jahn | Technology Notebook">
    <meta property="article:author" content="Marcin Jahn">
    <meta name="theme-color" content="white">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.cfa8f008.css" as="style"><link rel="preload" href="/assets/js/app.60e5ef95.js" as="script"><link rel="preload" href="/assets/js/2.509aea98.js" as="script"><link rel="preload" href="/assets/js/38.4343e12d.js" as="script"><link rel="prefetch" href="/assets/js/10.2f628158.js"><link rel="prefetch" href="/assets/js/100.e8d00495.js"><link rel="prefetch" href="/assets/js/101.5412944b.js"><link rel="prefetch" href="/assets/js/102.feadcc1e.js"><link rel="prefetch" href="/assets/js/103.385d5540.js"><link rel="prefetch" href="/assets/js/104.c238db1c.js"><link rel="prefetch" href="/assets/js/105.21e02e29.js"><link rel="prefetch" href="/assets/js/106.ae0efb5f.js"><link rel="prefetch" href="/assets/js/107.accf83ac.js"><link rel="prefetch" href="/assets/js/108.112902bd.js"><link rel="prefetch" href="/assets/js/109.809500d4.js"><link rel="prefetch" href="/assets/js/11.e89ffa34.js"><link rel="prefetch" href="/assets/js/110.37066cd6.js"><link rel="prefetch" href="/assets/js/111.70af5fb8.js"><link rel="prefetch" href="/assets/js/112.d5151658.js"><link rel="prefetch" href="/assets/js/113.63af056f.js"><link rel="prefetch" href="/assets/js/114.3a63b61c.js"><link rel="prefetch" href="/assets/js/115.b232f246.js"><link rel="prefetch" href="/assets/js/116.bf492c77.js"><link rel="prefetch" href="/assets/js/117.dcad6969.js"><link rel="prefetch" href="/assets/js/118.b05eda88.js"><link rel="prefetch" href="/assets/js/119.39f2f904.js"><link rel="prefetch" href="/assets/js/12.d6e4a587.js"><link rel="prefetch" href="/assets/js/120.45dbe6a5.js"><link rel="prefetch" href="/assets/js/121.9941b457.js"><link rel="prefetch" href="/assets/js/122.fc4f2ff3.js"><link rel="prefetch" href="/assets/js/123.c3cdb452.js"><link rel="prefetch" href="/assets/js/124.ae57edd4.js"><link rel="prefetch" href="/assets/js/125.80a7f80f.js"><link rel="prefetch" href="/assets/js/126.826ae28d.js"><link rel="prefetch" href="/assets/js/127.fe0c8441.js"><link rel="prefetch" href="/assets/js/128.c95d889d.js"><link rel="prefetch" href="/assets/js/129.acdbd954.js"><link rel="prefetch" href="/assets/js/13.f330b497.js"><link rel="prefetch" href="/assets/js/130.3413d67e.js"><link rel="prefetch" href="/assets/js/131.bce246a4.js"><link rel="prefetch" href="/assets/js/132.3c37f311.js"><link rel="prefetch" href="/assets/js/133.44e32f05.js"><link rel="prefetch" href="/assets/js/134.a6e4d78f.js"><link rel="prefetch" href="/assets/js/135.d7998fb2.js"><link rel="prefetch" href="/assets/js/136.c31601e7.js"><link rel="prefetch" href="/assets/js/137.4489b00b.js"><link rel="prefetch" href="/assets/js/138.8c6b88b7.js"><link rel="prefetch" href="/assets/js/139.2cffbefb.js"><link rel="prefetch" href="/assets/js/14.71349fad.js"><link rel="prefetch" href="/assets/js/140.07b8552f.js"><link rel="prefetch" href="/assets/js/15.7bf51c0f.js"><link rel="prefetch" href="/assets/js/16.7d676b66.js"><link rel="prefetch" href="/assets/js/17.07b6763a.js"><link rel="prefetch" href="/assets/js/18.f043472f.js"><link rel="prefetch" href="/assets/js/19.17683864.js"><link rel="prefetch" href="/assets/js/20.b384583d.js"><link rel="prefetch" href="/assets/js/21.3aced90b.js"><link rel="prefetch" href="/assets/js/22.7f6dda29.js"><link rel="prefetch" href="/assets/js/23.ca4f6e56.js"><link rel="prefetch" href="/assets/js/24.896bd9f6.js"><link rel="prefetch" href="/assets/js/25.c329a954.js"><link rel="prefetch" href="/assets/js/26.29ffd1e2.js"><link rel="prefetch" href="/assets/js/27.77aece92.js"><link rel="prefetch" href="/assets/js/28.f1c31003.js"><link rel="prefetch" href="/assets/js/29.f9e91935.js"><link rel="prefetch" href="/assets/js/3.61338c2e.js"><link rel="prefetch" href="/assets/js/30.03b95d9f.js"><link rel="prefetch" href="/assets/js/31.c3ddb45e.js"><link rel="prefetch" href="/assets/js/32.ec5f1b8d.js"><link rel="prefetch" href="/assets/js/33.8791656b.js"><link rel="prefetch" href="/assets/js/34.506b3ff9.js"><link rel="prefetch" href="/assets/js/35.c404fcfe.js"><link rel="prefetch" href="/assets/js/36.e1836413.js"><link rel="prefetch" href="/assets/js/37.f71813e6.js"><link rel="prefetch" href="/assets/js/39.86b5c2db.js"><link rel="prefetch" href="/assets/js/4.cb63b922.js"><link rel="prefetch" href="/assets/js/40.f874c287.js"><link rel="prefetch" href="/assets/js/41.9c247d6f.js"><link rel="prefetch" href="/assets/js/42.8d0f5758.js"><link rel="prefetch" href="/assets/js/43.a5721682.js"><link rel="prefetch" href="/assets/js/44.d660c752.js"><link rel="prefetch" href="/assets/js/45.3465f333.js"><link rel="prefetch" href="/assets/js/46.cd3c682f.js"><link rel="prefetch" href="/assets/js/47.114fda21.js"><link rel="prefetch" href="/assets/js/48.c1af4594.js"><link rel="prefetch" href="/assets/js/49.8b755298.js"><link rel="prefetch" href="/assets/js/5.7d01b04b.js"><link rel="prefetch" href="/assets/js/50.38fc6c56.js"><link rel="prefetch" href="/assets/js/51.f984821b.js"><link rel="prefetch" href="/assets/js/52.a0641e02.js"><link rel="prefetch" href="/assets/js/53.3d61bb74.js"><link rel="prefetch" href="/assets/js/54.f08e887f.js"><link rel="prefetch" href="/assets/js/55.2f445ff2.js"><link rel="prefetch" href="/assets/js/56.8d4e9474.js"><link rel="prefetch" href="/assets/js/57.402c1181.js"><link rel="prefetch" href="/assets/js/58.c8406587.js"><link rel="prefetch" href="/assets/js/59.d2665ee7.js"><link rel="prefetch" href="/assets/js/6.2bab3d21.js"><link rel="prefetch" href="/assets/js/60.88008ac1.js"><link rel="prefetch" href="/assets/js/61.c898b47f.js"><link rel="prefetch" href="/assets/js/62.c981d2b7.js"><link rel="prefetch" href="/assets/js/63.a58b38a0.js"><link rel="prefetch" href="/assets/js/64.dcf71fdb.js"><link rel="prefetch" href="/assets/js/65.824b3395.js"><link rel="prefetch" href="/assets/js/66.cf189a7a.js"><link rel="prefetch" href="/assets/js/67.55781b9b.js"><link rel="prefetch" href="/assets/js/68.beae0c8b.js"><link rel="prefetch" href="/assets/js/69.e0a89937.js"><link rel="prefetch" href="/assets/js/7.f9d1bfa8.js"><link rel="prefetch" href="/assets/js/70.30c3b7ea.js"><link rel="prefetch" href="/assets/js/71.809f7c73.js"><link rel="prefetch" href="/assets/js/72.57a698f6.js"><link rel="prefetch" href="/assets/js/73.b53894ad.js"><link rel="prefetch" href="/assets/js/74.63ed65cc.js"><link rel="prefetch" href="/assets/js/75.c0d4c45e.js"><link rel="prefetch" href="/assets/js/76.6b2c13c6.js"><link rel="prefetch" href="/assets/js/77.1202d861.js"><link rel="prefetch" href="/assets/js/78.5b3d3113.js"><link rel="prefetch" href="/assets/js/79.1024bda7.js"><link rel="prefetch" href="/assets/js/8.86a45292.js"><link rel="prefetch" href="/assets/js/80.bba3c10f.js"><link rel="prefetch" href="/assets/js/81.53080171.js"><link rel="prefetch" href="/assets/js/82.c90c52c9.js"><link rel="prefetch" href="/assets/js/83.5f963fe3.js"><link rel="prefetch" href="/assets/js/84.7b1334d1.js"><link rel="prefetch" href="/assets/js/85.850513de.js"><link rel="prefetch" href="/assets/js/86.b0556230.js"><link rel="prefetch" href="/assets/js/87.f907eded.js"><link rel="prefetch" href="/assets/js/88.b8e159ae.js"><link rel="prefetch" href="/assets/js/89.bfd2bba0.js"><link rel="prefetch" href="/assets/js/9.4e5349e1.js"><link rel="prefetch" href="/assets/js/90.722dea1c.js"><link rel="prefetch" href="/assets/js/91.81e3f5ce.js"><link rel="prefetch" href="/assets/js/92.4892370b.js"><link rel="prefetch" href="/assets/js/93.b752884b.js"><link rel="prefetch" href="/assets/js/94.cfed9643.js"><link rel="prefetch" href="/assets/js/95.88cff3d1.js"><link rel="prefetch" href="/assets/js/96.7506258a.js"><link rel="prefetch" href="/assets/js/97.98c8455f.js"><link rel="prefetch" href="/assets/js/98.e6bd0a5a.js"><link rel="prefetch" href="/assets/js/99.4ebe7885.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cfa8f008.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar boxshadow"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Marcin Jahn | Technology Notebook</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/technologies/" class="nav-link">
  Technologies
</a></div><div class="nav-item"><a href="/projects/" class="nav-link">
  Projects
</a></div><div class="nav-item"><a href="/meta/" class="nav-link">
  Meta
</a></div> <span class="external-services" data-v-10a38898><a target="_blank" href="https://www.linkedin.com/in/marcin-jahn-63a9b915b/?locale=en_US" data-v-f9b87572 data-v-10a38898><img src="/img/linkedin.webp" data-v-f9b87572></a><a target="_blank" href="https://github.com/marcinjahn" data-v-f9b87572 data-v-10a38898><img src="/img/github.webp" data-v-f9b87572></a></span> <!----></nav>  <ul class="sidebar-links"><li><a href="/programming/" aria-current="page" class="sidebar-link">/programming/</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/dotnet.webp"></span> <span>.NET</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/javascript.webp"></span> <span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/rust.webp"></span> <span>Rust</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/c.webp"></span> <span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/css.webp"></span> <span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span class="img-container"><img src="/sidebar-imgs/unity.webp"></span> <span>Unity</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span class="img-container"><img src="/sidebar-imgs/algorithms.webp"></span> <span>Algorithms</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/algorithms/big-o.html" class="sidebar-link">Big O Notation</a></li><li><a href="/programming/algorithms/arrays.html" class="sidebar-link">Array</a></li><li><a href="/programming/algorithms/linked-lists.html" class="sidebar-link">Linked List</a></li><li><a href="/programming/algorithms/queue.html" class="sidebar-link">Queue</a></li><li><a href="/programming/algorithms/hash-table.html" class="sidebar-link">Hash Table and Set</a></li><li><a href="/programming/algorithms/tree.html" class="sidebar-link">Tree</a></li><li><a href="/programming/algorithms/sorting.html" class="sidebar-link">Sorting</a></li><li><a href="/programming/algorithms/searching.html" aria-current="page" class="active sidebar-link">Searching</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/algorithms/searching.html#binary-search" class="sidebar-link">Binary Search</a></li><li class="sidebar-sub-header"><a href="/programming/algorithms/searching.html#boyer-moore-horspool" class="sidebar-link">Boyer-Moore-Horspool</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content"><div class="content__default"><h1 id="searching"><a href="#searching" class="header-anchor">#</a> Searching</h1> <h2 id="binary-search"><a href="#binary-search" class="header-anchor">#</a> Binary Search</h2> <p>A O(log n) algorithm that looks for a specified element in a sorted (!) array.</p> <h3 id="recurcive-algorithm"><a href="#recurcive-algorithm" class="header-anchor">#</a> Recurcive Algorithm</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">RecursiveBinarySearch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> sortedNumbers<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> target<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sortedNumbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token class-name"><span class="token keyword">var</span></span> partitionIndex <span class="token operator">=</span> sortedNumbers<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">[</span>partitionIndex<span class="token punctuation">]</span> <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> partitionIndex<span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">[</span>partitionIndex<span class="token punctuation">]</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> 
  <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> search <span class="token operator">=</span> <span class="token function">RecursiveBinarySearch</span><span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span>partitionIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// if (-1) gets returned, we need to propagate it back</span>
    <span class="token keyword">return</span> search <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">:</span>
      partitionIndex 
      <span class="token operator">+</span> search
      <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// since both partitionIndex and search are 0-based indexes, we need to +1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">RecursiveBinarySearch</span><span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span>partitionIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="iterative-algorithm"><a href="#iterative-algorithm" class="header-anchor">#</a> Iterative Algorithm</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">IterativeBinarySearch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> sortedNumbers<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> target<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sortedNumbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token class-name"><span class="token keyword">var</span></span> minIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token class-name"><span class="token keyword">var</span></span> maxIndex <span class="token operator">=</span> sortedNumbers<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>minIndex <span class="token operator">&lt;=</span> maxIndex<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> partitionIndex <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>maxIndex <span class="token operator">-</span> minIndex<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> minIndex<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">[</span>partitionIndex<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token keyword">return</span> partitionIndex<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>sortedNumbers<span class="token punctuation">[</span>partitionIndex<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      minIndex <span class="token operator">=</span> partitionIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      maxIndex <span class="token operator">=</span> partitionIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="boyer-moore-horspool"><a href="#boyer-moore-horspool" class="header-anchor">#</a> Boyer-Moore-Horspool</h2> <p>It's an algorithm for searching for a substring within a string. It uses a
<strong>Bad Match Table</strong> to store characters of the pattern we're searching for (a
hashmap). Each character is a key, and the value is the shift from the end of
the pattern where the given character can be found. While iterating through
source string's character's, we're looking for the last character of the
pattern. If we find it, we try to match the rest of the characters. If we find
any other character of the pattern, we try to shift the search window to match
the postion of the found character with the positon of it in the pattern.</p> <p>An example of a Bad Match Table for the word &quot;ROOM&quot;:</p> <table><thead><tr><th>CHARACTER</th> <th>SHIFT</th></tr></thead> <tbody><tr><td>R</td> <td>3</td></tr> <tr><td>O</td> <td>1</td></tr> <tr><td>M</td> <td>?</td></tr></tbody></table> <ul><li><p>the &quot;M&quot; character is a bit special - it should be kept outside of the hash map
for ease of access since we're using it all the time in the loop for matching.
In the code below I'm just using <code>pattern[length - 1]</code> to access the last
character.</p></li> <li><p>the &quot;R&quot; is on the 3rd index from the right (so, if we find character &quot;R&quot;, we
know that we need to shift our search window 3 characters to the right).</p></li> <li><p>the &quot;O&quot; character is there only once. Since keys in a hashmap cannot repeat,
we keep only the instance that is positioned the most to the right.</p></li> <li><p><strong>Time Complexity: O(mn)</strong> (average - O(n))</p></li></ul> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">record</span> <span class="token class-name">Match</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> Index<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Length<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Match<span class="token punctuation">&gt;</span></span> <span class="token function">BoyerMooreHorspool</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> input<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> pattern<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  <span class="token class-name"><span class="token keyword">var</span></span> length <span class="token operator">=</span> pattern<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>

  <span class="token class-name"><span class="token keyword">var</span></span> table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      table<span class="token punctuation">[</span>pattern<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> length <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      table<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token class-name"><span class="token keyword">var</span></span> matches <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Match<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name"><span class="token keyword">var</span></span> index <span class="token operator">=</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> input<span class="token punctuation">.</span>Length<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// last character matchees</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>input<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> pattern<span class="token punctuation">[</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token class-name"><span class="token keyword">var</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> length<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">[</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">!=</span> input<span class="token punctuation">[</span>index <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> length<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        matches<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Match</span><span class="token punctuation">(</span>index <span class="token operator">-</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      index <span class="token operator">+=</span> length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// some other character matches</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      index <span class="token operator">+=</span> table<span class="token punctuation">[</span>input<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// nothing matches</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      index <span class="token operator">+=</span> length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> matches<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The algorithm is efficient, because it skips groups of characters in the input
string that have no chance of being a part of the pattern.</p></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/algorithms/sorting.html" class="prev">
        Sorting
      </a></span> <!----></p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/8/2022, 6:48:56 PM</span></div></footer> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.60e5ef95.js" defer></script><script src="/assets/js/2.509aea98.js" defer></script><script src="/assets/js/38.4343e12d.js" defer></script>
  </body>
</html>
