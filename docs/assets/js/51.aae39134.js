(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{488:function(t,s,a){"use strict";a.r(s);var e=a(31),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),a("p",[t._v("ASP.NET Core offers the following kinds of appliations:")]),t._v(" "),a("ul",[a("li",[t._v("Razor Pages")]),t._v(" "),a("li",[t._v("MVC")]),t._v(" "),a("li",[t._v("Web APIs")])]),t._v(" "),a("p",[t._v("A common thing is the "),a("code",[t._v("HttpContext")]),t._v(" object, which flows through the middleware\ncontaining all the infromation about the request, with potential additions from\nthe middleware. The response is also added to the "),a("code",[t._v("HttpContext")]),t._v(" object.")]),t._v(" "),a("h2",{attrs:{id:"middleware"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#middleware"}},[t._v("#")]),t._v(" Middleware")]),t._v(" "),a("p",[t._v("The "),a("strong",[t._v("middleware")]),t._v(" are C# classes or functions that handle HTTP requests and\nresponses. They are chained together, forming a pipeline, similarly to how\n"),a("code",[t._v("HTTPHandler")]),t._v("s can be chained in an "),a("code",[t._v("HTTPClient")]),t._v(".")]),t._v(" "),a("p",[t._v("All the requests pass through the middleware, so it's the right place to handle\ncommon cross-cutting concerns. The middleware can process the request/response,\noptionally modify it and pass on in the pipeline.")]),t._v(" "),a("p",[t._v("Requests/responses travel through the pipeline as "),a("code",[t._v("HttpContext")]),t._v(" objects that can\nbe modified.")]),t._v(" "),a("p",[t._v("Middleware components should be small and handle just one responsibility.")]),t._v(" "),a("p",[t._v("Middleware can short-circuit the request causing it not to be passed to the\nmiddleware parts behind it. If some middleware receives a request, it will also\nreceive a response going back.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("404")]),t._v(" "),a("p",[t._v("ASP.NET Core adds a middleware returning "),a("code",[t._v("404")]),t._v(" in the end of the pipeline.\nIf none of our middleware handles the requests, that "),a("code",[t._v("404")]),t._v(" one handles it.")])]),t._v(" "),a("p",[t._v("Middleware is added to the "),a("code",[t._v("WebApplication")]),t._v(" (.NET 6) or to the\n"),a("code",[t._v("IApplicationBuilder")]),t._v(" (prior to .NET 6).")]),t._v(" "),a("p",[t._v("In general, middleware is added like this:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseMiddleware")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("WelcomePageMiddleware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Often, middleware comess with extension methods that are more readable:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseWelcomePage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// calls the above behind the scenes")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Use")]),t._v(" "),a("p",[t._v("Methods starting with "),a("code",[t._v("Use")]),t._v(" are a convention for adding middleware.")])]),t._v(" "),a("h3",{attrs:{id:"errors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#errors"}},[t._v("#")]),t._v(" Errors")]),t._v(" "),a("p",[t._v("Useful middleware:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("DeveloperExceptionPageMiddleware")]),t._v(" - displays stacktrace of an exception")]),t._v(" "),a("li",[a("code",[t._v("ExceptionHandlerMiddleware")]),t._v(" - alternative to the above, more suitable for\nproduction")]),t._v(" "),a("li",[a("code",[t._v("StatusCodePagesMiddleware")]),t._v(" - transforms raw error codes into some meaningful\nerror-pages.")])]),t._v(" "),a("h2",{attrs:{id:"razor-pages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#razor-pages"}},[t._v("#")]),t._v(" Razor Pages")]),t._v(" "),a("p",[t._v("Pages are stored in the "),a("code",[t._v(".cshtml")]),t._v(" files within the "),a("code",[t._v("pages")]),t._v(" directory of a\nproject. "),a("strong",[t._v("Razor")]),t._v(" is a templating syntax.")]),t._v(" "),a("p",[t._v("Here's an example of "),a("code",[t._v("Pages/Privacy.cshtml")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-cshtml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cshtml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token csharp language-csharp"}},[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Indicates that this is a Razor Page")])])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@model")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token csharp language-csharp"}},[t._v("PrivacyModel "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Links to a model file (Privacy.cshtml.cs)")])])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token block"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token csharp language-csharp"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// C# code that is not part of the result HTML")]),t._v("\n    ViewData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Title"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Privacy Policy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- Result HTML --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token value variable"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@")]),a("span",{pre:!0,attrs:{class:"token csharp language-csharp"}},[t._v("ViewData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Title"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Use this page to detail your site's privacy policy."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("The file name matches the URL path. "),a("code",[t._v("localhost/Privacy")]),t._v(" will run the\n"),a("code",[t._v("Pages/Privacy.cshtml")]),t._v(" page.")]),t._v(" "),a("h3",{attrs:{id:"models"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#models"}},[t._v("#")]),t._v(" Models")]),t._v(" "),a("p",[t._v("Complex logic for a page should be handled in a the "),a("code",[t._v("PageModel")]),t._v(' (a base class\nfor page models). We could use it to load data from some DB, etc.\nIt is a "code behind" file, similar to WPF.')]),t._v(" "),a("p",[t._v("An example:")]),t._v(" "),a("div",{staticClass:"language-cs extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cs"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PrivacyModel")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PageModel")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//base class")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ILogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("PrivacyModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" _logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrivacyModel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ILogger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("PrivacyModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        _logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("OnGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handler for GET requests")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// void return type means that HTML should be generated")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// IActionResult can return other things: JSONs, redirects, errors, etc.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"layouts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#layouts"}},[t._v("#")]),t._v(" Layouts")]),t._v(" "),a("p",[t._v("Razor Pages has a concept og "),a("strong",[t._v("layouts")]),t._v(", which is similar to components in SPA\nframeworks. It avoids duplication of common parts of web pages. Layouts can be\nfound in the "),a("code",[t._v("Pages/Shared")]),t._v(" directory.")])])}),[],!1,null,null,null);s.default=n.exports}}]);